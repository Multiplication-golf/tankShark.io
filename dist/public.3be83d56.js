!async function(){var e,t={};function a(e,t){return{x:t.clientX,y:t.clientY}}["1.webp","2.webp","3.webp","4.webp","5.webp","6.webp","7.webp","8.webp","9.webp","10.webp"].forEach(e=>{var a=new Image;a.src="http://127.0.0.1:5501/public/index.html"!==window.location.href?`/badges/${e}`:`/public/badges/${e}`,t[`/badges/${e}`]=a});let l=(e,t,a)=>{var l=function(e){let t=e.getBoundingClientRect();return{x:t.left+t.width/2,y:t.top+t.height/2}}(e);return Math.atan2(a-l.y,t-l.x)};function n(e){let t=e+"=",a=decodeURIComponent(document.cookie).split(";");for(let e=0;e<a.length;e++){let l=a[e];for(;" "==l.charAt(0);)l=l.substring(1);if(0==l.indexOf(t))return l.substring(t.length,l.length)}return""}let o=[];["0.webp","1.webp","2.webp","3.webp","4.webp","5.webp","6.webp","7.webp","8.webp","9.webp","10.webp"].forEach(e=>{let t=new Image;t.src=("https://tankshark.fun/"!==window.location.href?"/public/skins/":"/skins/")+e,o.push(t)});var i={};o.forEach((e,t)=>{i[`${t}.png`]=e});var r=!0,s=!1,d=!0,c=!0;function h(){let l=new WebSocket(document.getElementById("IP").value);l.binaryType="arraybuffer";let s=null;var y=document.createElement("canvas");let g=document.getElementById("ghostCanvas"),m=y.getContext("2d",{willReadFrequently:!0});y.width=window.innerWidth,y.height=window.innerHeight,document.getElementById("game").appendChild(y),y.id="myCanvas",y.style["z-index"]="5",y.style.position="absolute",y.style.top="0",y.style.left="0",y.itemprop="gamePlatform",document.getElementsByTagName("body")[0].style.cursor="https://tankshark.fun/"!==window.location.href?`url('${window.location.origin}/public/targetpointer1.cur'), auto`:`url('${window.location.origin}/targetpointer1.cur'), auto`;var p=Math.PI/180;let u=performance.now(),f=[];var b={basic:{"size-m":1,"speed-m":1,"damage-m":1,"health-m":1,"regen-m":1,fov:1,"BodyDamage-m":1,"reaload-m":1,upgradeLevel:15,upgrades:{},cannons:[]}},v=document.getElementById("gridDark"),k=document.getElementById("gridLight"),w=[],x={},S=y.width/2,T=y.height/2,E=100,I=100,B=0,P=1,L=10,M=1,z=40,R=3,A="basic",W=null,$=0,U=0,_=!1,H=!1,F=null,N=!1,O=0,q=[],j=[],X=!1,G=!1,J=!0,Y=!0,V=1,K={},Z=[],Q=!1,ee=!1,et=0,ea=0,el=0,en=0,eo={},ei=null,er=[],es=[],ed=[],ec=!1,eh=[],ey=750,eg=[!0],em=10,ep=[0],eu=0,ef=[],eb=(g.getBoundingClientRect(),0),ev=0,ek=y.width,ew=y.height,ex=1,eS=v.style,eT=k.style,eE=Math.sqrt(3)/2,eI=Math.PI,eB=0,eP="start",eL=0,eD=0,eC=0,eM=.3125*y.width,ez=.02909796314*y.height,eR=!1,eA=[],eW="",e$=null,eU=.24739583333*y.width,e_=.24088541666*y.width,eH=.1953125*y.width,eF=.03100775193*y.height,eN=.00969932104*y.height,eO=[3,5,7,8,10,11,13],eq=30,eo={},ei=null,eh=[],Z=[],ej=[],eX=[],eG=[],eJ=[],eY=!1,eV=n("userId"),eK="",eZ={},eQ=[],e0=0,eg=[!0],ep=[0],eE=Math.sqrt(3)/2,e1="grey",eO=[3,5,7,8,10,11,13],e2=1,e5=[],e3=[],e4=0,eP="start",eL=0,eD=0,eB=0,eG=[],e9=["assets/dislike.webp","assets/like.webp"],e8=[],e7={0:15},e6=document.getElementById("socialContainer");let te={Health:1,"Body Damage":1,Regen:1,"Bullet Pentration":1,"Bullet Speed":1,"Bullet Damage":1,"Bullet Reload":1,Speed:1};function tt(){setTimeout(()=>{Y=!0},300),Y=!1}function ta(e,t){if(l.readyState===WebSocket.OPEN)try{l.send(JSON.stringify({type:e,data:t}))}catch(e){if(e0>2)return;setTimeout(()=>{window.location.reload()},2500),alert("There is an error or socket disconnection. Please report this if the error is not related to a closing state error."),alert("error",e)}else setTimeout(()=>{},1),setTimeout(()=>{alert(`There is a disconnection. ${l.readyState}`)},0),console.log(e,t),e0++}e6.style.display="none";let tl=()=>Math.atan2(ea-window.innerHeight/2,et-window.innerWidth/2);function tn(e,t,a,...l){let n=!1;if(e.forEach(e=>{"number"!=typeof e&&(n=!0)}),t.forEach(e=>{"number"!=typeof e&&(n=!0)}),(3!==e.length||3!==t.length)&&(n=!0),n)throw Error("Bad rgbs");var o=e.map((e,l)=>e=t[l]*a+e*(1-a));return l.forEach((e,t)=>{tn(e,l[t],a)}),o}let to=new Date;to.setTime(to.getTime()+864e7);let ti="expires="+to.toUTCString();function tr(e){var t=!1;if(void 0!=e.upgrades)for(let r=0;r<Object.keys(e.upgrades).length;r++){var a=Object.keys(e.upgrades)[r];if($>=e.upgrades[a].level-1){if(!1===t){var l=document.getElementById("tanktiles");l.style.display="block",l.style.left=0,l.style.animation="2s 1 move",l.innerHTML="",t=!0}var n=e.upgrades[a],o=document.createElement("img"),i=n.img;l.appendChild(o),o.src="tanktiles/"+i+".png",o.style="width: 6vw; height: 6vw; margin: 10px; z-index: 100;",o.addEventListener("click",function(t){t.stopPropagation(),l.style.display="none",A=Object.keys(e.upgrades)[r],x[s].__type__=A;var a=(e=b[A]).cannons;M*=e["size-m"],L*=e["speed-m"],em*=e["damage-m"],P*=e["regen-m"],R*=e["BodyDamage-m"],I*=e["health-m"],E>I&&(E=I),e.AutoRoting&&(Q=!0,ee=!0),0!==e.fov&&tv(e.fov),ta("typeChange",{health:E,speed:L,size:M,bodyDamage:R,__type__:A,state:eP,statecycle:eL,playerHealTime:B,maxhealth:I,playerReheal:P,FOV:tb,Regenspeed:eq,statsTree:{Health:te.Health,"Body Damage":te["Body Damage"],Regen:te.Regen,"Bullet Pentration":te["Bullet Pentration"],"Bullet Speed":te["Bullet Speed"],"Bullet Damage":te["Bullet Damage"],"Bullet Reload":te["Bullet Reload"],Speed:te.Speed}}),setTimeout(()=>{ep=[],eg=[];for(let e=0;e<Object.keys(a).length;e++)ep.push(0),eg.push(!0);for(let t in ef.forEach(e=>{e.playerid===s&&(ta("deletAuto",{CannonID:e.CannonID}),clearInterval(e),e=null)}),a){let l=a[t];if("autoCannon"===l.type||"SwivelAutoCannon"===l.type){let n=1e3*Math.random()+1e3*Math.random();ta("autoCannonADD",{CannonID:n,angle:0,_type_:l.type,cannonWidth:0});let o=b[A],i={CannonID:n,angle:0,_type_:l.type,cannonWidth:0};function e(){var n=b[A];if(i.playerid===s){let e=0;for(let e in n.cannons)n.cannons[e],l.autoindex;var r=a[t]["offSet-x"];"playerX"===a[t]["offSet-x"]&&(r=M*z*ex),a[t]["offSet-x-multpliyer"]&&(r*=-1);let o=tl();if("SwivelAutoCannon"===a[t].type)var[d,c]=tf(r,0,180/Math.PI*o);"SwivelAutoCannon"===a[t].type&&ta("Autofire",{playerX:S+d,playerY:T+c,cannon:l,bullet_damage:em,bullet_speed:4,bullet_size:15,bullet_pentration:2,extracannon_:t,_cannon:i}),"autoCannon"===a[t].type&&ta("Autofire",{playerX:S-r,playerY:T,cannon:l,bullet_damage:em,bullet_speed:4,bullet_size:15,bullet_pentration:2,extracannon_:t,_cannon:i})}setTimeout(()=>{e()},ey*o["reaload-m"]*l.reloadM*e2)}setTimeout(()=>{e()},ey*o["reaload-m"]*l.reloadM*e2),eh.push({cannonINT:e,autoID:n})}}},100)})}}}function ts(){if(eC=0==(eC=(O-e7[$-1])/(e7[$]-e7[$-1]))||Number.isNaN(eC)?1:eC,O/e7[$]>=1)for(U+=1,tr(b[A]),$+=1,eD=0,eC=(O-e7[$-1])/(e7[$]-e7[$-1]),M+=.005*M,ta("Sizeup",{plus:.005*M}),tv(e4);O/e7[$]>=1;)$+=1,U+=1,M+=.005*M,ta("Sizeup",{plus:.005*M}),tv(e4),eD=0,eC=(O-e7[$-1])/(e7[$]-e7[$-1]),tr(b[A])}function td(){if(H){let a=eJ.find(e=>e.teamID===x[s].team);if(a.lowerLevelPlayers)var t=a.lowerLevelPlayers.includes({id:s,username:e});else var t=!1;a.players.forEach(e=>{var l=document.getElementById("teamcontainer"),n=document.createElement("div");if(n.classList.add("team"),e.id===a.owner.id?n.innerText=e.username+" -":n.innerText=e.username,e.id===a.owner.id){var o=document.createElement("img");o.src="assets/crownIcon.png",n.appendChild(o),o.style.width="1.6em",o.style.height="1.3em",o.style["margin-left"]="5px",o.style["margin-top"]="0px",o.style["margin-bottom"]="-5px"}if(l.appendChild(n),a.owner.id===s&&e.id!==a.owner.id&&a.powers.canKick&&(n.addEventListener("mouseover",()=>{if(!eY){eY=!0;var t=document.createElement("img");t.src="assets/kickButton.png",t.style.width="1.5em",t.style.height="1.5em",t.style["text-align"]="left",t.addEventListener("click",()=>{ta("kickplayer",{id:e.id,team:a.teamID})}),n.appendChild(t),n.addEventListener("mouseleave",()=>{eY=!1,n.children[0].remove()})}}),added)){var i=document.createElement("img");i.src="assets/kickButton.png",i.style.width="1.5em",i.style.height="1.5em",i.style["text-align"]="left",i.addEventListener("click",()=>{ta("kickplayer",{id:e.id,team:a.teamID})}),n.appendChild(i)}if(a.owner.id===s||t){var r=t?a.powers.lowerlevelpowers.canDedicatePower:a.powers.canDedicatePower,d=t?a.powers.lowerlevelpowers.canDededicatePower:a.powers.canDededicatePower;if(r&&a.owner.id!==e.id&&a.lowerLevelPlayers&&!a.lowerLevelPlayers.includes(e)){var c=document.createElement("img");c.src="assets/premoteArrow.png",n.appendChild(c),c.style.width="1.6em",c.style.height="1.3em",c.style["margin-left"]="5px",c.style["margin-top"]="0px",c.style["margin-bottom"]="-5px",c.style.float="right";let t=()=>{ta("premotePlayer",{premote:e,MYteamID:a.teamID}),c.removeEventListener("click",t)};c.addEventListener("click",t)}if(d&&a.owner.id!==e.id&&a.lowerLevelPlayers&&a.lowerLevelPlayers.includes(e)){var h=document.createElement("img");h.src="assets/demoteArrow.png",n.appendChild(c),h.style.width="1.6em",h.style.height="1.3em",h.style["margin-left"]="5px",h.style["margin-top"]="0px",h.style["margin-bottom"]="-5px",premdemoteArrowoteArrow.style.float="right";let t=()=>{ta("demotePlayer",{premote:e,MYteamID:a.teamID}),h.removeEventListener("click",t)};h.addEventListener("click",t)}}})}else eJ.forEach(e=>{var t=document.getElementById("teamcontainer"),a=document.createElement("div"),l=document.createElement("img");l.src="assets/expand.png",a.classList.add("team"),a.innerText=e.name,t.appendChild(a),a.appendChild(l);var n=document.createElement("div"),o=document.createElement("p");o.innerText=`
          Team type: ${e.govType}
          Taxes: 
          Flat rate ${e.simpleTax}
          Player based rate ${e.playerTax}
          ScheduledBased based rate ${e.ScheduledBasedTax} per ${6e4*e.ScheduledBasedTaxInterval} minet interval
          `,"Constitutional"===e.govType&&(o.innerText+=`${e.constitution}`),n.classList.add("team"),n.style.height="50%",n.style.overflow="auto",n.style.display="none",t.appendChild(n),n.appendChild(o),l.style.width="1.6em",l.style.height="1.3em",l.style["margin-top"]="0px",l.style["margin-bottom"]="-5px",l.style["margin-right"]="3px",l.style.float="right";let i=!1;l.addEventListener("click",()=>{l.style.rotate=i?"180deg":"0deg",n.style.display=i?"none":"block",i=!i}),a.addEventListener("click",()=>{Array.from(t.children).forEach(e=>{e.classList.remove("glow")}),a.classList.add("glow"),W=e.teamID})})}document.cookie="score=25000000;"+ti+";path=/",document.getElementsByClassName("outer-box")[0].classList.add("outer-onwer-box"),document.getElementsByClassName("inner-box")[0].classList.add("inner-onwer-box"),document.getElementById("upgradesBox").style.display="block",document.getElementById("HomeBaseUpgrade").addEventListener("click",()=>{document.getElementById("confermationScreen").style.display="flex"}),document.getElementById("placeNo").addEventListener("click",()=>{document.getElementById("confermationScreen").style.display="none"}),document.getElementById("placeYes").addEventListener("click",()=>{document.getElementById("confermationScreen").style.display="none",ta("requestUpgrade",{upgradeType:"buildBase",teamId:F})}),document.getElementById("upgradeHealth").addEventListener("click",()=>{ta("requestUpgrade",{upgradeType:"statUpgrade",stat:"Health",teamId:F})}),document.getElementById("upgradeBodyDamage").addEventListener("click",()=>{ta("requestUpgrade",{upgradeType:"statUpgrade",stat:"Body Damage",teamId:F})}),document.getElementById("upgradeRegen").addEventListener("click",()=>{ta("requestUpgrade",{upgradeType:"statUpgrade",stat:"Regen",teamId:F})}),document.getElementById("upgradeBulletPentration").addEventListener("click",()=>{ta("requestUpgrade",{upgradeType:"statUpgrade",stat:"Bullet Pentration",teamId:F})}),document.getElementById("upgradeBulletSpeed").addEventListener("click",()=>{ta("requestUpgrade",{upgradeType:"statUpgrade",stat:"Bullet Speed",teamId:F})}),document.getElementById("upgradeBulletDamage").addEventListener("click",()=>{ta("requestUpgrade",{upgradeType:"statUpgrade",stat:"Body Damage",teamId:F})}),document.getElementById("upgradeBulletReload").addEventListener("click",()=>{ta("requestUpgrade",{upgradeType:"statUpgrade",stat:"Bullet Reload",teamId:F})}),document.getElementById("upgradeSpeed").addEventListener("click",()=>{ta("requestUpgrade",{upgradeType:"statUpgrade",stat:"Speed",teamId:F})});var tc=document.getElementById("posttext");function th(e,t,a,l,n,o,i,r,s,d,c){e.fillStyle=r,!1!==d&&(e.strokeStyle=d),e.beginPath(),e.roundRect(t,a,l,n,o),e.fill(),d&&e.stroke(),e.closePath();var h=l*i;if(h<0&&(h=0),e.fillStyle=s,e.beginPath(),e.moveTo(t+o,a),h>o?(e.lineTo(t+h-o,a),h<l-o?(e.quadraticCurveTo(t+h,a,t+h,a+o),e.lineTo(t+h,a+n-o),e.quadraticCurveTo(t+h,a+n,t+h-o,a+n)):(e.lineTo(t+l-o,a),e.quadraticCurveTo(t+l,a,t+l,a+o),e.lineTo(t+l,a+n-o),e.quadraticCurveTo(t+l,a+n,t+l-o,a+n),e.lineTo(t+h-o,a+n)),e.lineTo(t+o,a+n),e.quadraticCurveTo(t,a+n,t,a+n-o),e.lineTo(t,a+o),e.quadraticCurveTo(t,a,t+o,a)):(e.beginPath(),e.roundRect(t,a,h,n,o)),e.closePath(),e.fill(),c){e.fillStyle="#0228c2",e.strokeStyle="black",e.textAlign="center",e.font=`bold ${40*(1+(1-tb))}px Nunito`,e.strokeText($,y.width/2,y.height-6*eN),e.fillText($,y.width/2,y.height-6*eN);try{e.drawImage(e$,y.width/2-eF/2,y.height-15*eN,eF,eF)}catch{}}}document.getElementById("postBite").addEventListener("click",()=>{ta("postBite",{message:tc.value,teamID:F}),tc.value=""}),window.onbeforeunload=e=>{confirm("Reloading will not save your progress!")||(e.preventDefault(),e.returnValue="")},l.onopen=function(){setTimeout(()=>{let n,g,v,k;console.time("preconnect"),Promise.allSettled([new Promise((e,t)=>{n=e}),new Promise((e,t)=>{g=e}),new Promise((e,t)=>{v=e}),new Promise((e,t)=>{k=e})]).then(()=>{console.timeEnd("preconnect"),tv(0),document.getElementById("full-screen").style.display="none",function a(l){m.clearRect(0,0,y.width,y.height);var n=1+(1-tp/y.width),h=1+(1-tu/y.height);let g=(l-u)/1e3;u=l,f.push(1/g),f.length>60&&f.shift(),f.reduce((e,t)=>e+t),f.length,eX.forEach(e=>{e.x+e.size>0+eb&&e.x<y.width+eb+e.size&&e.y-ev>0-e.size&&e.y-e.size<y.height+ev&&e.rings.reduce((t,a)=>(m.beginPath(),m.arc(e.x-eb,e.y-ev,e.size+t,0,2*Math.PI),m.fillStyle=a.color,m.strokeStyle=a.color,m.globalAlpha=e.trans-a.transMinus<=0?.001:e.trans-a.transMinus,m.lineWidth=a.size,m.stroke(),m.closePath(),t+=a.size,m.globalAlpha=1,t),0)}),m.lineWidth=1,m.lineJoin="round",w.forEach(e=>{var t=e.x,a=e.y;if(t+e.size>eb&&t<y.width+eb+e.size&&a-ev>-e.size&&a-e.size<y.height+ev&&e.health>=0){if(m.save(),e.transparency&&(m.globalAlpha=e.transparency,e.transparency<0&&(m.globalAlpha=0)),m.translate(t-eb,a-ev),m.rotate(e.angle*p),"square"===e.type&&(m.fillStyle=e.color,m.fillRect(-e.size/2,-e.size/2,e.size,e.size),m.strokeStyle="GoldenRod",m.lineWidth=5,m.strokeRect(-e.size/2,-e.size/2,e.size,e.size),m.rotate(-e.angle*p),e.health<e.maxhealth&&tx(e)),"triangle"===e.type){let t=e.size,a=Math.sqrt(3)/2*t;m.beginPath(),m.moveTo(-t/2,a/3),m.lineTo(t/2,a/3),m.lineTo(0,-2*a/3),m.closePath(),m.fillStyle=e.color,m.fill(),m.strokeStyle="Darkred",m.lineWidth=5,m.stroke(),m.rotate(-e.angle*p),e.health<e.maxhealth&&tx(e)}if("pentagon"===e.type){m.fillStyle=e.color;let t=e.size*ex,a=e.angle*p;eQ=[];for(let e=0;e<5;e++){let l=2*e*Math.PI/5+a,n=0+t*Math.cos(l),o=0+t*Math.sin(l);eQ.push({x:n,y:o})}m.beginPath(),m.moveTo(eQ[0].x,eQ[0].y);for(let e=1;e<eQ.length;e++)m.lineTo(eQ[e].x,eQ[e].y);m.closePath(),m.fill(),m.strokeStyle="#3976cc",m.beginPath(),m.moveTo(eQ[0].x,eQ[0].y);for(let e=1;e<eQ.length;e++)m.lineTo(eQ[e].x,eQ[e].y);if(m.closePath(),m.lineWidth=5,m.stroke(),m.rotate(-e.angle*p),e.health<e.maxhealth){m.fillStyle="black",m.beginPath(),m.roundRect(-60,0+(35+(e.size-50)),120+(e.size-50),10,5),m.fill(),m.closePath();let t=e.health/e.maxhealth*(120+(e.size-50));m.fillStyle="green",m.beginPath(),m.roundRect(-60,0+(35+(e.size-50)),t,10,5),m.fill(),m.closePath()}}if(/octagon/.test(e.type)){m.fillStyle=e.type.replace("octagon","")===F?"#b3ffff":"#A0DDFA";let t=e.size*ex,a=e.angle*p;eQ=[];for(let e=0;e<8;e++){let l=2*e*Math.PI/8+a,n=0+t*Math.cos(l),o=0+t*Math.sin(l);eQ.push({x:n,y:o})}m.beginPath(),m.moveTo(eQ[0].x,eQ[0].y);for(let e=1;e<eQ.length;e++)m.lineTo(eQ[e].x,eQ[e].y);m.closePath(),m.fill(),m.strokeStyle=e.type.replace("octagon","")===F?"#b1fcfc":"#98D6F4",m.beginPath(),m.moveTo(eQ[0].x,eQ[0].y);for(let e=1;e<eQ.length;e++)m.lineTo(eQ[e].x,eQ[e].y);if(m.closePath(),m.lineWidth=25,m.stroke(),m.rotate(-e.angle*p),e.health<e.maxhealth){m.fillStyle="black",m.beginPath(),m.roundRect(-60,0+(35+(e.size-50)),120+(e.size-50),10,5),m.fill(),m.closePath();let t=e.health/e.maxhealth*(120+(e.size-50));m.fillStyle="green",m.beginPath(),m.roundRect(-60,0+(35+(e.size-50)),t,10,5),m.fill(),m.closePath()}}if(m.restore(),"square:boss"===e.type){m.save(),m.translate(t-eb,a-ev);var l=ej.find(t=>t.id===e.randomID);l=void 0===l?{id:0,cannons:[{cannonW:0},{cannonW:0},{cannonW:0},{cannonW:0}]}:l;for(let t=0;t<4;t++){m.fillStyle="#b3b3b3";let a=e.angle*(eI/180),r=eI/180*90*t;m.rotate(a+r);var n=e.size/2-60;let s=30*ex,d=t+1<l.cannons.length?t+1:0,c=s/2+70+n-l.cannons[d].cannonW;var o=s/2,i=80*ex/2;m.beginPath(),m.moveTo(c-70,0-o),m.lineTo(c-70,0+o),m.lineTo(c,0+i),m.lineTo(c,0-i),m.closePath(),m.fill(),m.strokeStyle="lightgrey",m.lineWidth=3,m.beginPath(),m.moveTo(c-70,0-o),m.lineTo(c-70,0+o),m.lineTo(c,0+i),m.lineTo(c,0-i),m.closePath(),m.stroke(),m.rotate(-(a+r))}m.restore(),m.save(),m.translate(t-eb,a-ev),m.rotate(e.angle*p),m.fillStyle=e.color,m.fillRect(-e.size/2,-e.size/2,e.size*ex,e.size*ex),m.strokeStyle="GoldenRod",m.lineWidth=5,m.strokeRect(-e.size/2,-e.size/2,e.size*ex,e.size*ex),m.rotate(-e.angle*p),e.health<e.maxhealth&&tx(e),m.restore()}if("triangle:boss"===e.type){m.save(),m.translate(t-eb,a-ev);var l=ej.find(t=>t.id===e.randomID);l=void 0===l?{id:0,cannons:[{cannonW:0}]}:l,m.fillStyle="#b3b3b3";let r=e.angle*(eI/180);m.rotate(r+eI);var n=e.size/2-120;let s=30*ex,d=s/2+70+n-l.cannons[0].cannonW;var o=s/2,i=80*ex/2;m.beginPath(),m.moveTo(d-70,0-o),m.lineTo(d-70,0+o),m.lineTo(d,0+i),m.lineTo(d,0-i),m.closePath(),m.fill(),m.strokeStyle="lightgrey",m.lineWidth=3,m.beginPath(),m.moveTo(d-70,0-o),m.lineTo(d-70,0+o),m.lineTo(d,0+i),m.lineTo(d,0-i),m.closePath(),m.stroke(),m.rotate(-(r+eI)),m.restore(),m.save(),m.translate(t-eb,a-ev),m.rotate(e.angle*p+90*p),m.fillStyle=e.color;let c=e.size,h=c*Math.sqrt(3)/2;m.beginPath(),m.moveTo(-c/2,h/3),m.lineTo(c/2,h/3),m.lineTo(0,-2*h/3),m.closePath(),m.fill(),m.strokeStyle="#ff66f7",m.lineWidth=5,m.stroke(),m.rotate(-e.angle*p-90*p),e.health<e.maxhealth&&tx(e),m.restore()}m.globalAlpha=1}}),m.lineJoin="miter";let v=[];for(let e in ed.forEach(e=>{{m.beginPath(),m.moveTo(e[2].road.x-eb,e[2].road.y-ev);let t=x[e[2].road.id].team===x[s].team&&null!==x[e[2].road.id].team&&null!==x[s].team;(e[2].road.id===s||t)&&(m.fillStyle="#3999f9",m.strokeStyle="#5f79f5"),e.forEach(e=>{m.lineTo(e.road.x-eb,e.road.y-ev)}),m.globalAlpha=.8,m.stroke(),m.globalAlpha=.3,m.fill(),m.closePath(),m.globalAlpha=1}}),er.forEach(e=>{var t=e.xstart-(e.xstart-eb),a=e.ystart-(e.ystart-ev),l=e.x,n=e.y;if(l+e.size>eb&&l-e.size<y.width+eb&&n+e.size>ev&&n-e.size<y.height+ev){if(3!==e.Zlevel)return void v.push(e);if(e.transparency&&(m.globalAlpha=e.transparency),m.beginPath(),"basic"===e.type){var o=x[e.id]?.team===x[s]?.team&&x[e.id]?.team!==null&&x[s]?.team!==null;e.id===s||o?(m.fillStyle="blue",m.strokeStyle="darkblue"):(m.fillStyle="red",m.strokeStyle="darkred");let i=e.size;m.arc(l-t,n-a,i,0,2*Math.PI),m.fill(),m.lineWidth=5,m.stroke(),m.closePath()}m.globalAlpha=1}}),v.forEach(e=>{var t=e.x,a=e.y;if(t+e.size>eb&&t-e.size<y.width+eb&&a+e.size>ev&&a-e.size<y.height+ev){if(2===e.Zlevel&&e.id===s)return void es.push(e);if(e.transparency&&(m.globalAlpha=e.transparency),m.beginPath(),"basic"===e.type||"sheild"===e.type){if("sheild"!==e.type)var l=x[e.id]?.team===x[s]?.team&&x[e.id]?.team!==null&&x[s]?.team!==null;else{m.globalCompositeOperation="destination-over";var l=e.teamID===F}e.id===s||l?(m.fillStyle="blue",m.strokeStyle="darkblue"):(m.fillStyle="red",m.strokeStyle="darkred");let n=e.size;m.arc(t-(e.xstart-(e.xstart-eb)),a-(e.ystart-(e.ystart-ev)),n,0,2*Math.PI),m.fill(),m.lineWidth=5,m.stroke(),m.closePath(),m.globalCompositeOperation="source-over"}else if("FreeNecromancer"===e.type)m.save(),m.translate(t-eb,a-ev),m.rotate(e.angle),m.fillStyle="#f2c705",m.fillRect(-e.size/2,-e.size/2,e.size,e.size),m.strokeStyle="#e0b700",m.lineWidth=5,m.strokeRect(-e.size/2,-e.size/2,e.size,e.size),m.restore();else if("trap"===e.type){var l=x[e.id].team===x[s].team&&null!==x[e.id].team&&null!==x[s].team;e.id===s||l?(m.fillStyle="blue",m.strokeStyle="darkblue"):(m.fillStyle="red",m.strokeStyle="darkred");let t=e.vertices,a=t[2].x-(e.xstart-(e.xstart-eb)),n=t[2].y-(e.ystart-(e.ystart-ev)),o=t[1].x-(e.xstart-(e.xstart-eb)),i=t[1].y-(e.ystart-(e.ystart-ev)),r=t[0].x-(e.xstart-(e.xstart-eb)),d=t[0].y-(e.ystart-(e.ystart-ev));m.beginPath(),m.moveTo(a,n);let c={x:(a+r)/2,y:(n+d)/2},h={x:(o+a)/2,y:(i+d)/2+5},y={x:(a+r)/2+5,y:(n+d)/2};m.quadraticCurveTo(c.x,c.y,o,i),m.quadraticCurveTo(h.x,h.y,r,d),m.quadraticCurveTo(y.x,y.y,a,n),m.fill(),m.lineWidth=5,m.stroke(),m.closePath()}else if("directer"===e.type){var l=x[e.id].team===x[s].team&&null!==x[e.id].team&&null!==x[s].team;e.id===s||l?(m.fillStyle="blue",m.strokeStyle="darkblue"):(m.fillStyle="red",m.strokeStyle="darkred"),m.save(),m.translate(t-eb,a-ev),m.rotate(e.angle+eI/180*90);let n=3*e.size*ex,o=n*eE;m.beginPath(),m.moveTo(0,-o/2),m.lineTo(-n/2,o/2),m.lineTo(n/2,o/2),m.closePath(),m.fill(),m.stroke()}else if("roadMap"===e.type){var l=x[e.id].team===x[s].team&&null!==x[e.id].team&&null!==x[s].team;e.id===s||l?(m.fillStyle="blue",m.strokeStyle="darkblue"):(m.fillStyle="red",m.strokeStyle="darkred"),m.save(),m.translate(t-eb,a-ev);for(let t=0;t<2;t++){m.rotate(e.angle+180*t*(eI/180));let a=3*e.size*ex,l=a*eE;m.beginPath(),m.moveTo(0,-l/2),m.lineTo(-a/2,l/2),m.lineTo(a/2,l/2),m.closePath(),m.fill(),m.stroke()}}else if("FreeSwarm"===e.type){m.fillStyle="#ff7df8",m.strokeStyle="#ff66f7",m.save(),m.translate(t-eb,a-ev),m.rotate(e.angle);let l=3*e.size*ex,n=l*eE;m.beginPath(),m.moveTo(0,-n/2),m.lineTo(-l/2,n/2),m.lineTo(l/2,n/2),m.closePath(),m.fill(),m.lineWidth=5,m.stroke()}else if("AutoBullet"===e.type){var l=x[e.id].team===x[s].team&&null!==x[e.id].team&&null!==x[s].team;e.id===s||l?(m.fillStyle="blue",m.strokeStyle="darkblue"):(m.fillStyle="red",m.strokeStyle="darkred");let i=e.size*ex;m.arc(t-(e.xstart-(e.xstart-eb)),a-(e.ystart-(e.ystart-ev)),i,0,2*Math.PI),m.fill(),m.lineWidth=5,m.stroke(),m.closePath();let r=null;ef.forEach(t=>{t.playerid===e.uniqueid&&(r=t)}),m.save(),m.translate(t-(e.xstart-(e.xstart-eb)),a-(e.ystart-(e.ystart-ev)));var n=e.size/2,o=e.size/2;m.rotate(r.angle);let d=-n/2+o-ep,c=-o/2;m.fillStyle="#b3b3b3",m.fillRect(d,c-5,n+15,o+10),m.strokeStyle="lightgrey",m.lineWidth=3,m.strokeRect(d,c-5,n+15,o+10),m.rotate(-r.angle),m.closePath(),m.beginPath(),m.arc(0,0,n/2+7,0,2*Math.PI,!1),m.fill(),m.lineWidth=5,m.stroke(),m.closePath()}else if("rocketer"===e.type){m.save(),m.translate(t-eb,a-ev),m.rotate(e.angle);let n=b[x[e.id].__type__].cannons[e.parentindex]["cannon-width-top"]/1.7,o=b[x[e.id].__type__].cannons[e.parentindex]["cannon-width-bottom"]/1.7;m.fillStyle="#b3b3b3";var i=o/2,r=n/2;m.beginPath(),m.moveTo(0-n,0-i),m.lineTo(0-n,0+i),m.lineTo(0,0+r),m.lineTo(0,0-r),m.closePath(),m.fill(),m.strokeStyle="lightgrey",m.lineWidth=3,m.beginPath(),m.moveTo(0-n,0-i),m.lineTo(0-n,0+i),m.lineTo(0,0+r),m.lineTo(0,0-r),m.closePath(),m.stroke(),m.restore();var l=x[e.id].team===x[s].team&&null!==x[e.id].team&&null!==x[s].team;e.id===s||l?(m.fillStyle="blue",m.strokeStyle="darkblue"):(m.fillStyle="red",m.strokeStyle="darkred");let d=e.size*ex;m.beginPath(),m.arc(t-(e.xstart-(e.xstart-eb)),a-(e.ystart-(e.ystart-ev)),d,0,2*Math.PI),m.fill(),m.lineWidth=5,m.stroke(),m.closePath()}m.restore(),m.globalAlpha=1}}),x)if(x.hasOwnProperty(e)&&e!=s){let t=x[e],a=b[t.__type__],l=a.cannons,o=t.x,d=t.y,h=t.size;a.decor&&a.decor.forEach(e=>{if("octaspinner"===e.type){m.fillStyle="black",m.save(),m.translate(o-eb+e.offsetX,d-ev+e.offsetY);let a=t.cannon_angle;m.rotate(a+e.offsetAngle),m.beginPath();for(let t=0;t<8;t++){let a=2*Math.PI/8*t;0===t?m.moveTo(e.size*Math.cos(a),e.size*Math.sin(a)):m.lineTo(e.size*Math.cos(a),e.size*Math.sin(a))}m.closePath(),m.fill(),m.restore()}});let y=m.createRadialGradient(o-eb,d-ev,M*z/1.5,o-eb,d-ev,eZ.radius);y.addColorStop(eZ.build[0],"#FFFFFF00"),L?y.addColorStop(eZ.build[1],"#61f7ff"):y.addColorStop(eZ.build[1],"#ff2121"),y.addColorStop(eZ.build[2],"#FFFFFF00"),m.beginPath(),m.arc(o-eb,d-ev,eZ.radius,0,2*Math.PI,!1),m.fillStyle=y,m.fill(),m.closePath();for(let e=0;e<Object.keys(l).length;e++){m.fillStyle="#b3b3b3";let a=l[e],n=a["cannon-width"]*h,i=a["cannon-height"]*h;if("basicCannon"===a.type){m.save(),m.translate(o-eb,d-ev);let l=t.cannon_angle,r=a["offset-angle"];m.rotate(l+r);let s=-n/2+i+a["offSet-x"]-t.cannonW[e],c=-i/2+a["offSet-y"];m.fillRect(s,c,n,i),m.strokeStyle="lightgrey",m.lineWidth=3,m.strokeRect(s,c,n,i),m.restore()}else if("trapezoid"===a.type||"directer"===a.type){m.save(),m.translate(o-eb,d-ev);let l=t.cannon_angle,n=a["offset-angle"];m.rotate(l+n);let r=a["cannon-width-bottom"]*t.size*ex,s=r/2+i+a["offSet-x"]-t.cannonW[e],c=-i/2+i/2-a["offSet-y"],h=i,y=a["cannon-width-top"]*t.size*ex;var k=r/2,B=y/2;m.beginPath(),m.moveTo(s-h,c-k),m.lineTo(s-h,c+k),m.lineTo(s,c+B),m.lineTo(s,c-B),m.closePath(),m.fill(),m.strokeStyle="lightgrey",m.lineWidth=3,m.beginPath(),m.moveTo(s-h,c-k),m.lineTo(s-h,c+k),m.lineTo(s,c+B),m.lineTo(s,c-B),m.closePath(),m.stroke(),m.restore()}else if("trap"===a.type||"paver"===a.type){let l=a["cannon-height"];m.save(),m.translate(o-eb,d-ev);let r=t.cannon_angle,s=a["offset-angle"],c=a["trap-to-cannon-ratio"];m.rotate(r+s);let h=-n/2+l+a["offSet-x"]-t.cannonW[e],y=n*(1-c),g=-i/2+a["offSet-y"];m.fillRect(h,g,n-y,i),m.strokeStyle="lightgrey",m.lineWidth=3,m.strokeRect(h,g,n-y,i);let p=1.4*i,u=i;h+=n-c;var k=u/2,B=p/2;if(g+=k,m.beginPath(),m.moveTo(h-y,g-k),m.lineTo(h-y,g+k),m.lineTo(h,g+B),m.lineTo(h,g-B),m.closePath(),m.fill(),m.strokeStyle="lightgrey",m.lineWidth=3,m.beginPath(),m.moveTo(h-y,g-k),m.lineTo(h-y,g+k),m.lineTo(h,g+B),m.lineTo(h,g-B),m.closePath(),m.stroke(),m.restore(),"paver"===a.type){n/=2,i/=2,m.save(),m.translate(o-eb,d-ev);let l=t.cannon_angle,r=a["offset-angle"];m.rotate(l+r);let s=-n/2+i+a["offSet-x"]-t.cannonW[e],c=-i/2+a["offSet-y"];m.fillRect(s,c,n,i),m.strokeStyle="lightgrey",m.lineWidth=3,m.strokeRect(s,c,n,i),m.restore()}}else if("AutoBulletCannon"===a.type){m.save(),m.translate(o-eb,d-ev);let l=t.cannon_angle,r=a["offset-angle"];m.rotate(l+r);let s=-n/2+i+a["offSet-x"]-t.cannonW[e],c=-i/2+a["offSet-y"];m.fillRect(s,c,n,i),m.strokeStyle="lightgrey",m.lineWidth=3,m.strokeRect(s,c,n,i),m.beginPath(),m.arc(s+40+n/4,c+i/2,M*ex*z/4,0,2*Math.PI,!1),m.fill(),m.lineWidth=5,m.strokeStyle="lightgrey",m.stroke(),m.closePath(),m.restore()}else if("rocketer"===a.type){m.save(),m.translate(o-eb,d-ev);let a=l[e];var P=a["offset-angle"];let n=t.cannon_angle;m.rotate(n+P);let r=a["cannon-width-top"]*h,s=a["cannon-width-bottom"]*h,c=a["cannon-height"]*h,y=s/2+i+a["offSet-x"]-t.cannonW[e],g=-i/2+i/2+a["offSet-y"];var k=s/2,B=r/2;m.beginPath(),m.moveTo(y-c,g-k),m.lineTo(y-c,g+k),m.lineTo(y,g+B),m.lineTo(y,g-B),m.closePath(),m.fill(),m.strokeStyle="lightgrey",m.lineWidth=3,m.beginPath(),m.moveTo(y-c,g-k),m.lineTo(y-c,g+k),m.lineTo(y,g+B),m.lineTo(y,g-B),m.closePath(),m.stroke(),m.fillRect(i+(i-25)*(1+(1-t.size)),g-B,i-40,r),m.strokeStyle="lightgrey",m.lineWidth=3,m.strokeRect(i+(i-25)*(1+(1-t.size)),g-B,i-40,r),m.restore()}}m.beginPath(),m.arc(o-eb,d-ev,t.size*z,0,2*Math.PI,!1);var L=x[t.id].team===x[s].team&&null!==x[t.id].team&&null!==x[s].team;if("start"===t.state||"damaged"===t.state){let e={1:4,2:3,3:2,4:1,5:.1},a=t.statecycle%10<=5?t.statecycle%10:e[t.statecycle%10-5],l=tn([130,130,130],[255,255,255],a/=10);m.fillStyle=`rgb(${l[0]} ${l[1]} ${l[2]})`}else m.fillStyle="#828282",m.strokeStyle="#aaaaaa";m.fill(),m.lineWidth=5,m.stroke(),m.closePath(),"0.webp"!==t.skin&&(m.save(),m.translate(o-eb,d-ev),m.rotate(t.cannon_angle),m.drawImage(i[t.skin],0-t.size*z,0-t.size*z,2*z,2*z),m.restore());let g=[];j.forEach(e=>{e.id===t.id&&g.push(e)}),r&&g.forEach(e=>{m.save(),e.hidetime<Date.now()&&1>1-(Date.now()-e.hidetime)/500&&(m.globalAlpha=1-(Date.now()-e.hidetime)/500),m.translate(o-eb,d-ev-40*t.size-30*g.length-25),m.fillStyle="black",m.textAlign="center",m.font=`bold ${21*n}px Nunito`,m.fillText(e.text,0,0),m.globalAlpha=1,m.restore()}),m.beginPath(),m.fillStyle="black",m.roundRect(o-eb-50*ex,d-ev+55*ex,90*ex,10*t.size*ex,10*t.size/2),m.fill(),m.closePath(),m.beginPath();let p=t.health/t.maxhealth*90*t.size*ex;m.fillStyle="green",m.roundRect(o-eb-50*ex,d-ev+55*ex,p,10*t.size*ex,10*t.size/2),m.fill(),m.closePath();for(let a=0;a<Object.keys(l).length;a++){let n;m.fillStyle="#b3b3b3";let i=l[a],r=i["cannon-width"]*h,s=i["cannon-height"]*h;if(ef.forEach(t=>{t.playerid===e&&t.autoindex===a&&(n=t.angle,D=t.cannonWidth)}),"autoCannon"===i.type){m.save();var D,[R,W]=tf();m.translate(o-eb,d-ev);let e=n,a=i["offset-angle"];m.rotate(e+a);var $=i["offSet-x"];"playerX"===i["offSet-x"]&&($=2*t.size);let l=-r/2+s+$,c=-s/2+i["offSet-y"];m.beginPath(),m.fillRect(l-5,c-2.5,r+10-D,s+5),m.strokeStyle="lightgrey",m.lineWidth=3,m.strokeRect(l-5,c-2.5,r+10-D,s+5),m.rotate(-(e+a)),m.arc(0,0,r/2,0,2*Math.PI,!1),m.fill(),m.stroke(),m.closePath(),m.restore()}else if("SwivelAutoCannon"===i.type){let e,l;m.save(),ef.forEach(n=>{n.playerid===t.id&&n.autoindex===a&&(e=n.angle,l=n.cannonWidth)});var $=i["offSet-x"];"playerX"===i["offSet-x"]&&($=M*z),i["offSet-x-multpliyer"]&&($*=-1);var[R,W]=tf($,0,180/Math.PI*tl());m.translate(o-eb,d-ev);let n=e,c=i["offset-angle"];m.rotate(n+c);let h=-r/2+s+0,y=-s/2+i["offSet-y"];m.beginPath(),m.fillRect(h-5,y-2.5,r+10-l,s+5),m.strokeStyle="lightgrey",m.lineWidth=3,m.strokeRect(h-5,y-2.5,r+10-l,s+5),m.rotate(-(n+c)),m.arc(0,0,r/2,0,2*Math.PI,!1),m.fill(),m.stroke(),m.closePath(),m.restore()}}m.strokeStyle="black",m.fillStyle="white",m.textAlign="center",m.font="bold 20px Nunito",m.strokeText(t.score,o-eb,d-ev-55),m.fillText(t.score,o-eb,d-ev-55),c&&(m.strokeText(t.username,o-eb,d-ev-75),m.fillText(t.username,o-eb,d-ev-75)),m.lineWidth=1,m.strokeStyle="grey",m.strokeRect(o-eb-50,d-ev+55,90*t.size*ex,10*t.size*ex)}m.fillStyle=e1,_||function(t,a){eB+=.1,tw.announcements=q,m.fillStyle=e1;let l=tl();if(!X&&(J&&(K["]"]?(x[s].score+=50,O=x[s].score,ts()):K.ArrowLeft&&K.ArrowUp||K.a&&K.w?tm(-1,-1):K.ArrowLeft&&K.ArrowDown||K.a&&K.s?tm(-1,1):K.ArrowRight&&K.ArrowUp||K.d&&K.w?tm(1,-1):K.ArrowRight&&K.ArrowDown||K.d&&K.s?tm(1,1):K.ArrowUp||K.w?tm(0,-1):K.ArrowDown||K.s?tm(0,1):K.ArrowLeft||K.a?tm(-1,0):(K.ArrowRight||K.d)&&tm(1,0)),Y))if(K["-"])tv(.1),tt();else if(K["1"])te.Health<8&&U>0&&(te.Health+=1,U-=1,ta("statUpgrade",{Upgradetype:"Health",UpgradeLevel:1})),tt();else if(K["2"])te["Body Damage"]<8&&U>0&&(te["Body Damage"]+=1,U-=1,ta("statUpgrade",{Upgradetype:"Body Damage",UpgradeLevel:1})),tt();else if(K["3"])te.Regen<8&&U>0&&(te.Regen+=1,U-=1,ta("statUpgrade",{Upgradetype:"Regen",UpgradeLevel:1})),tt();else if(K["4"])te["Bullet Pentration"]<8&&U>0&&(te["Bullet Pentration"]+=1,U-=1,ta("statUpgrade",{Upgradetype:"Bullet Pentration",UpgradeLevel:1})),tt();else if(K["5"])te["Bullet Speed"]<8&&U>0&&(te["Bullet Speed"]+=1,U-=1,ta("statUpgrade",{Upgradetype:"Bullet Speed",UpgradeLevel:1})),tt();else if(K["6"])te["Bullet Damage"]<8&&U>0&&(te["Bullet Damage"]+=1,U-=1,ta("statUpgrade",{Upgradetype:"Bullet Damage",UpgradeLevel:1})),tt();else if(K["7"])te["Bullet Reload"]<8&&U>0&&(te["Bullet Reload"]+=1,U-=1,ta("statUpgrade",{Upgradetype:"Bullet Reload",UpgradeLevel:1})),tt();else if(K["8"])te.Speed<8&&U>0&&(te.Speed+=1,U-=1,ta("statUpgrade",{Upgradetype:"Speed",UpgradeLevel:1})),tt();else if(K["="])ex+=.1;else if(K.e){if(ta("autoFiringUpdate",{autoFiring:!ec}),ee)return;ec=!ec,tt()}else K.c&&(Q&&!ee?ta("unrotating",{}):ta("rotate",{autoAngle:180/eI*l,autoIntevals:eh,playerSize:M,FOV:tb,canvaswidth:y.width,canvasheight:y.height}),Q=!Q,tt());tw.run();let n=b[A],i=n.cannons,r=M*ex;n.decor&&n.decor.forEach(e=>{if("octaspinner"===e.type){m.fillStyle="black",m.save(),m.translate(ek/2+e.offsetX,ew/2+e.offsetY),m.rotate(l+e.offsetAngle),m.beginPath();for(let t=0;t<8;t++){let a=2*Math.PI/8*t;0===t?m.moveTo(e.size*Math.cos(a),e.size*Math.sin(a)):m.lineTo(e.size*Math.cos(a),e.size*Math.sin(a))}m.closePath(),m.fill(),m.restore()}});let d=m.createRadialGradient(y.width/2,y.height/2,M*z/1.5,y.width/2,y.height/2,eZ.radius);d.addColorStop(eZ.build[0],"#FFFFFF00"),d.addColorStop(eZ.build[1],"#61f7ff"),d.addColorStop(eZ.build[2],"#FFFFFF00"),m.beginPath(),m.arc(y.width/2,y.height/2,eZ.radius,0,2*Math.PI,!1),m.fillStyle=d,m.fill(),m.closePath();for(let e=0;e<Object.keys(i).length;e++){m.fillStyle="#b3b3b3";let t=i[e],a=t["cannon-width"]*r,n=t["cannon-height"]*r;if("basicCannon"===t.type){m.save(),m.translate(ek/2,ew/2);let o=t["offset-angle"];m.rotate(l+o);let i=-a/2+n+t["offSet-x"]-ep[e],r=-n/2+t["offSet-y"];m.fillRect(i,r,a,n),m.strokeStyle="lightgrey",m.lineWidth=3,m.strokeRect(i,r,a,n),m.restore()}else if("trapezoid"===t.type||"directer"===t.type){m.save(),m.translate(ek/2,ew/2);let t=i[e];var c=t["offset-angle"];m.rotate(l+c);let a=t["cannon-width-top"]*r,o=t["cannon-width-bottom"]*r,s=t["cannon-height"]*r,d=o/2+n+t["offSet-x"]-ep[e],y=-n/2+n/2+t["offSet-y"];var h=o/2,g=a/2;m.beginPath(),m.moveTo(d-s,y-h),m.lineTo(d-s,y+h),m.lineTo(d,y+g),m.lineTo(d,y-g),m.closePath(),m.fill(),m.strokeStyle="lightgrey",m.lineWidth=3,m.beginPath(),m.moveTo(d-s,y-h),m.lineTo(d-s,y+h),m.lineTo(d,y+g),m.lineTo(d,y-g),m.closePath(),m.stroke(),m.restore()}if("trap"===t.type||"paver"===t.type){m.save(),m.translate(ek/2,ew/2);let o=t["offset-angle"],i=t["trap-to-cannon-ratio"];m.rotate(l+o);let r=-a/2+n+t["offSet-x"]-ep[e],s=a*(1-i),d=-n/2+t["offSet-y"];m.fillRect(r*M*ex,d*M*ex,a-s,n),m.strokeStyle="lightgrey",m.lineWidth=3,m.strokeRect(r*M*ex,d*M*ex,a-s,n);var p=1.4*n,u=n;r+=a-i;var h=u/2,g=p/2;if(d+=h-i,m.beginPath(),m.moveTo(r-s,d-h),m.lineTo(r-s,d+h),m.lineTo(r,d+g),m.lineTo(r,d-g),m.closePath(),m.fill(),m.strokeStyle="lightgrey",m.lineWidth=3,m.beginPath(),m.moveTo(r-s,d-h),m.lineTo(r-s,d+h),m.lineTo(r,d+g),m.lineTo(r,d-g),m.closePath(),m.stroke(),m.restore(),"paver"===t.type){a/=2,n/=2,m.save(),m.translate(ek/2,ew/2);let o=t["offset-angle"];m.rotate(l+o);let i=-a/2+n+t["offSet-x"]-ep[e],r=-n/2+t["offSet-y"];m.fillRect(i,r,a,n),m.strokeStyle="lightgrey",m.lineWidth=3,m.strokeRect(i,r,a,n),m.restore()}}if("SwivelAutoCannon"===t.type){let l,o;m.save(),ef.forEach(t=>{t.playerid===s&&t.autoindex===e&&(l=t.angle,o=t.cannonWidth)});var f=t["offSet-x"];"playerX"===t["offSet-x"]&&(f=M*z),t["offSet-x-multpliyer"]&&(f*=-1);var[v,k]=tf(f,0,180/Math.PI*tl());m.translate(ek/2+v,k+ew/2);let i=l,r=t["offset-angle"];m.rotate(i+r);let d=-a/2+n+0,c=-n/2+t["offSet-y"];m.beginPath(),m.fillRect(d-5,c-2.5,a+10-o,n+5),m.strokeStyle="lightgrey",m.lineWidth=3,m.strokeRect(d-5,c-2.5,a+10-o,n+5),m.rotate(-(i+r)),m.arc(0,0,a/2,0,2*Math.PI,!1),m.fill(),m.stroke(),m.closePath(),m.restore()}else if("AutoBulletCannon"===t.type){m.save(),m.translate(ek/2,ew/2);let o=t["offset-angle"];m.rotate(l+o);let i=-a/2+n+t["offSet-x"]-ep[e],r=-n/2+t["offSet-y"];m.fillRect(i,r,a,n),m.strokeStyle="lightgrey",m.lineWidth=3,m.strokeRect(i,r,a,n),m.beginPath(),m.arc(i+40+a/4,r+n/2,M*ex*z/4,0,2*Math.PI,!1),m.fill(),m.lineWidth=5,m.strokeStyle="lightgrey",m.stroke(),m.closePath(),m.restore()}else if("rocketer"===t.type){m.save(),m.translate(ek/2,ew/2);let t=i[e];var c=t["offset-angle"];m.rotate(l+c);let a=t["cannon-width-top"]*r,o=t["cannon-width-bottom"]*r,s=t["cannon-height"]*r,d=o/2+n+t["offSet-x"]-ep[e],y=-n/2+n/2+t["offSet-y"];var h=o/2,g=a/2;m.beginPath(),m.moveTo(d-s,y-h),m.lineTo(d-s,y+h),m.lineTo(d,y+g),m.lineTo(d,y-g),m.closePath(),m.fill(),m.strokeStyle="lightgrey",m.lineWidth=3,m.beginPath(),m.moveTo(d-s,y-h),m.lineTo(d-s,y+h),m.lineTo(d,y+g),m.lineTo(d,y-g),m.closePath(),m.stroke(),m.fillRect(n+(n-25)*(1+(1-M)),y-g,n-40,a),m.strokeStyle="lightgrey",m.lineWidth=3,m.strokeRect(n+(n-25)*(1+(1-M)),y-g,n-40,a),m.restore()}es.forEach(e=>{var t=e.x-Math.abs(2*e.size*(ex-1)),a=e.y-Math.abs(2*e.size*(ex-1));if(e.transparency&&(m.globalAlpha=e.transparency),m.beginPath(),"basic"===e.type){e.id===s?(m.fillStyle="blue",m.strokeStyle="darkblue"):(m.fillStyle="red",m.strokeStyle="darkred");let l=e.size*ex;m.arc(t-(e.xstart-(e.xstart-eb)),a-(e.ystart-(e.ystart-ev)),l,0,2*Math.PI),m.fill(),m.lineWidth=5,m.stroke(),m.closePath()}m.globalAlpha=1}),es=[]}if(m.beginPath(),m.arc(y.width/2,y.height/2,M*z,0,2*Math.PI,!1),"start"===eP||"damaged"===eP){let e=eL%10<=5?eL%10:({1:4,2:3,3:2,4:1,5:.1})[eL%10-5],t=tn([130,130,130],[255,255,255],e/=10);m.fillStyle=`rgb(${t[0]} ${t[1]} ${t[2]})`}else m.fillStyle="#828282";m.fill(),m.lineWidth=5,m.strokeStyle="#aaaaaa",m.stroke(),0!==C&&(m.save(),m.translate(y.width/2,y.height/2),m.rotate(l),m.drawImage(o[C],0-M*z,0-M*z,2*z,2*z),m.restore()),m.fillStyle="black",m.beginPath(),m.roundRect(y.width/2-45,y.height/2+55,90,10,5),m.fill(),m.closePath(),m.strokeStyle="black",m.fillStyle="white",m.textAlign="center",m.font=`bold ${20*t}px Nunito`,m.strokeText(O,y.width/2,y.height/2-55),m.fillText(O,y.width/2,y.height/2-55),m.strokeText(e,y.width/2,y.height/2-75),m.fillText(e,y.width/2,y.height/2-75);for(let e=0;e<Object.keys(i).length;e++){let t;m.fillStyle="#b3b3b3";let a=i[e],l=a["cannon-width"]*r,n=a["cannon-height"]*r;if(ef.forEach(a=>{a.playerid===s&&a.autoindex===e&&(t=a.angle,w=a.cannonWidth)}),"autoCannon"===a.type){m.save();var w,f=a["offSet-x"];"playerX"===a["offSet-x"]&&(f=M*z),a["offSet-x-multpliyer"]&&(f*=-1);var[v,k]=tf(f,0,180/Math.PI*tl());m.translate(y.width/2+v,k+y.height/2);let e=t,o=a["offset-angle"];m.rotate(e+o);let i=-l/2+n+0,r=-n/2+a["offSet-y"];m.beginPath(),m.fillRect(i-5,r-2.5,l+10-w,n+5),m.strokeStyle="lightgrey",m.lineWidth=3,m.strokeRect(i-5,r-2.5,l+10-w,n+5),m.rotate(-(e+o)),m.arc(0,0,l/2,0,2*Math.PI,!1),m.fill(),m.stroke(),m.closePath(),m.restore()}}let B=E/I*90;m.fillStyle="green",m.beginPath(),m.roundRect(y.width/2-45,y.height/2+55,B,10,5),m.fill(),m.closePath(),m.save(),m.translate(ek-150*t,ew-150*t),m.fillStyle="#fcfafa",m.beginPath(),m.roundRect(0,0,125*t,125*t,5),m.fill(),m.moveTo(0,0),m.lineWidth=+t,m.strokeStyle="#e3e3e3";for(let e=0;e<13;e++)m.moveTo(10.3*e*t,0),m.lineTo(10.3*e*t,125*t),m.stroke();m.closePath(),m.moveTo(0,0),m.lineWidth=+t,m.strokeStyle="#e3e3e3";for(let e=0;e<13;e++)m.moveTo(0,10.3*e*t),m.lineTo(125*t,10.3*e*t),m.stroke();m.closePath(),m.lineWidth=5,m.strokeStyle="grey",m.beginPath(),m.roundRect(0,0,125*t,125*t,5),m.stroke(),m.closePath(),m.textAlign="center",m.strokeText("players: "+Object.keys(x).length,62.5*t,-25*a),m.fillText("players: "+Object.keys(x).length,62.5*t,-25*a),m.globalAlpha=.5,m.fillStyle="#579bfa";let P=62.5*t,L=62.5*t,D=30*t,R=eB;eQ=[];for(let e=0;e<5;e++){let t=2*e*Math.PI/5+R,a=P+D*Math.cos(t),l=L+D*Math.sin(t);eQ.push({x:a,y:l})}m.beginPath(),m.moveTo(eQ[0].x,eQ[0].y);for(let e=1;e<eQ.length;e++)m.lineTo(eQ[e].x,eQ[e].y);m.closePath(),m.fill(),m.strokeStyle="#3976cc",m.beginPath(),m.moveTo(eQ[0].x,eQ[0].y);for(let e=1;e<eQ.length;e++)m.lineTo(eQ[e].x,eQ[e].y);m.closePath(),m.globalAlpha=1,m.beginPath(),m.translate(((S+2500)/80+35)*t,((T+2500)/80+35)*a),m.rotate(l+90*Math.PI/180),m.arc(((S+2500)/80+35)*t,((T+2500)/80+35)*a,M*ex*2,0,2*Math.PI,!1);let W=M*t*2;if(m.beginPath(),m.moveTo(0,-1.5*a),m.lineTo(-(W/2)*t,1.5*a),m.lineTo(W/2*t,1.5*a),m.closePath(),m.fillStyle="blue",m.fill(),m.lineWidth=2,m.strokeStyle="darkblue",m.stroke(),m.closePath(),m.beginPath(),m.rotate(-(l+90*Math.PI/180)),e8.forEach(e=>{e.id!==s&&(m.arc(e.x,e.y,4,0,2*Math.PI,!1),m.fillStyle="blue",m.fill(),m.lineWidth=2,m.strokeStyle="darkblue")}),m.restore(),X){m.globalAlpha=.5,m.fillStyle="#a3a3a3",m.fillRect(0,0,y.width,y.height),m.globalAlpha=.8,m.beginPath(),m.fillStyle="#96ceff",m.strokeStyle="#41a4fa";let e=30*eN+eK.length*(1.2*eN);m.roundRect(y.width/2-e/2,y.height/2-2.5*eN,e,5*eN,5),m.fill(),m.stroke(),m.globalAlpha=1,m.textAlign="left",m.font=`bold ${30*t}px Nunito`,m.fillStyle="black",m.fillText(eK,y.width/2-(e/2-5),y.height/2+1.5*eN),m.closePath();var $=m.measureText(eK).width+3;G&&(m.beginPath(),m.lineWidth=1,m.strokeStyle="black",m.moveTo(y.width/2-(e/2-5)+$,y.height/2-1.5*eN),m.lineTo(y.width/2-(e/2-5)+$,y.height/2+1.5*eN),m.stroke(),m.closePath())}window.innerWidth-475<el&&el<window.innerWidth-275&&en>10&&en<110?(m.strokeStyle="#4fe5ff",m.lineWidth=7):(m.strokeStyle="#0e589d",m.lineWidth=5),m.fillStyle="#45bbff",m.beginPath(),m.roundRect(y.width-eU,eN,20*eN,10*eN,5),m.fill(),m.stroke(),m.closePath(),m.fillStyle="#00a0fd",m.beginPath(),m.roundRect(y.width-e_,2.5*eN,17.5*eN,7*eN,5),m.fill(),m.closePath(),m.textAlign="center",m.font=`bold ${40*(2-tb)}px Nunito`,m.fillStyle="black",m.fillText("Teams",y.width-eH,7.5*eN),eC>eD&&(eD+=.07,(0===eC||eC>1)&&(eD=0))}(n,h),m.strokeStyle="black",m.lineWidth=5,m.beginPath(),m.moveTo(-5e3,-5e3),m.lineTo(5e3,-5e3),m.lineTo(5e3,5e3),m.lineTo(-5e3,5e3),m.lineTo(-5e3,-5e3),m.stroke(),eT.top=`calc(-${1e4*tb/2}px - ${ev*tb}px)`,eT.left=`calc(-${1e4*tb/2}px - ${eb*tb}px)`,eS.top=`calc(-${1e4*tb/2}px - ${ev*tb}px)`,eS.left=`calc(-${1e4*tb/2}px - ${eb*tb}px)`,th(m,y.width/2-eM/2,y.height-.03879728419*y.height,eM,ez,10,eD+.05,"black","#00f7ff",!1,!0);let N=0;U>0&&(m.font="26px Nunito",m.strokeStyle="#89faa7",m.strokeText(`+${U}`,20+145*n/2,y.height-34*h*9),m.textAlign="center",m.font="bold 25px Nunito",m.fillStyle="#14fc52",m.fillText(`+${U}`,20+145*n/2,y.height-34*h*9));for(let e=Object.keys(te).length-1;e>=0;e-=1){let t=te[Object.keys(te)[e]],a=Object.keys(te)[e],l=e5[e]||"red";th(m,20,y.height-34*h*N-40,145*n,25*h,10,t/8,"black",l,"#242424",!1),m.textAlign="center",m.font=`bold ${15*(1+(1-tb))}px Nunito`,m.fillStyle="white",m.fillText(`${a}:${t}`,20+145*n/2,y.height-34*h*N-40+17.5*h),N++}if(H)for(let e=Object.keys(te).length-1;e>=0;e-=1){let t=eJ.find(e=>e.teamID===x[s].team),a=t.stats[Object.keys(t.stats)[e]],l=Object.keys(t.stats)[e],o=e3[e]||"red";th(m,20,y.height-300*h*N-40,145*n,25*h,10,a/8,"black",o,"#242424",!1),m.textAlign="center",m.font=`bold ${15*(1+(1-tb))}px Nunito`,m.fillStyle="white",m.fillText(`${l}:${a}`,20+145*n/2,y.height-300*h*N-40+17.5*h),N++}m.font="bold 30px Nunito",m.strokeStyle="black",m.strokeText("leaderboard",y.width-125*n,25),m.textAlign="center",m.fillStyle="#00f7ff",m.fillText("leaderboard",y.width-125*n,25),d&&eA.forEach((e,a)=>{eA[0].score&&(e.score,eA[0].score),eA[0].score,th(m,y.width-257.5*n,50+30*a,245*n,27*h,10,e.score/eA[0].score,"#23badb","#4eddfc","#242424",!1),m.textAlign="center",m.font="bold 20px Nunito",m.fillStyle="black",m.fillText(`${e.name} \u{27A0} ${e.score}`,y.width-125*n,72+30*a*h),m.drawImage(t[e.badge],y.width-(40+205*n)*n,52+30*a*h,eF,40*h/1.8)}),requestAnimationFrame(a)}()});var eY,eY=new URLSearchParams(location).get("team");let e0={id:null,x:S,y:T,health:E,speed:L,size:M,bodyDamage:R,cannonW:ep,cannonH:0,__type__:A,cannon_angle:tl(),score:O,username:e,level:$,state:eP,statecycle:eL,playerHealTime:B,maxhealth:I,playerReheal:P,FOV:tb,canvasW:y.width,canvasH:y.height,MouseX:et,Regenspeed:eq,MouseY:ea,screenWidth:y.width,screenHeight:y.height,visible:!0,team:F,userId:eV,autoFiring:ec,skin:D,isCrazy:!1,teamKey:eY,statsTree:{Health:1,"Body Damage":1,Regen:1,"Bullet Pentration":1,"Bullet Speed":1,"Bullet Damage":1,"Bullet Reload":1,Speed:1}};ta("newPlayer",e0),ta("HANDSHAKE",{}),(e$=new Image).onload=function(){m.drawImage(e$,y.width/2,y.height-60)},e$.src=`https://deip-io3.glitch.me${eW}?nocache=${Date.now()}`,l.onmessage=function(t){try{let e=JSON.parse(t.data);a=e.type,o=e.data}catch{let e=function(e){var t=protobuf.Root.fromJSON({nested:{GameObject:{fields:{angle:{type:"float",id:1},color:{type:"string",id:2},health:{type:"float",id:3},maxhealth:{type:"int32",id:4},size:{type:"float",id:5},type:{type:"string",id:6},weight:{type:"float",id:7},x:{type:"float",id:8},y:{type:"float",id:9},transparency:{type:"float",id:10},randomID:{type:"double",id:11}}},GameObjectList:{fields:{objects:{rule:"repeated",type:"GameObject",id:1}}}}}).lookupType("GameObjectList");if(!e.data)throw Error("event.data is missing");let a=new Uint8Array(e.data);return t.decode(a)}(t);a=e.type,o=e.data,w=e.objects;return}switch(a){case"newId":s=o,k();break;case"playerUpdated":x[o.id]=o,console.log("Player updated:",o);break;case"new_X_Y":if(o.id!==s)return;eb=o.x,T+=o.y,ev=o.y,S+=o.x;break;case"explosionUpdate":eX=o;break;case"CannonWidthUpdate":var a,o;ef.find(e=>e.CannonID===o.CannonID).cannonWidth=o.cannonWidth;break;case"minimapUpdate":e8=o;break;case"Config":ey=o.baseFireInterval,e4=o.scaleUp,eZ=o.colorGradeint,z=o.playerBaseSize;var i=document.getElementById("gridDark"),r=document.getElementById("gridLight");for(let e=0;e<o.map.size/500;e++)for(let e=0;e<o.map.size/500;e++){let e=document.createElement("div"),t=document.createElement("img");t.style.width="100%",t.style.height="100%",t.src="backgrounds/hexlight.webp";let a=e.style;a.width="999px",a.height="999px",a.backgroundColor="white",a.border="1px solid black",e.appendChild(t),r.appendChild(e)}for(let e=0;e<o.map.size/500;e++)for(let e=0;e<o.map.size/500;e++){let e=document.createElement("div"),t=document.createElement("img");t.style.width="100%",t.style.height="100%",t.src="backgrounds/hexdark.webp";let a=e.style;a.width="999px",a.height="999px",a.backgroundColor="white",a.border="1px solid black",e.appendChild(t),i.appendChild(e)}n();break;case"requests":eG=o,function e(){var t,a,l=document.getElementById("requestJoin");if(eG.length<=0){l.style.display="none";return}var n=document.getElementById("allowYes"),o=document.getElementById("allowNo");l.style.display="block",l.children[1]&&l.children[1].remove();var i=document.createElement("p");i.style="color: #00ffff; font-size: 16px",i.innerText=x[eG[0].requester].username,l.appendChild(i),t=()=>{ta("allowYes",eG[0]),eG.shift(),o.removeEventListener("click",a),e()},a=()=>{ta("allowNo",eG[0]),eG.shift(),n.removeEventListener("click",t),e()},n.addEventListener("click",t,{once:!0}),o.addEventListener("click",a,{once:!0})}();break;case"RETURNtankmeta":b=o,g();break;case"NewMessages":j=o;break;case"playerMessage":{j.push({text:o.text,exspiretime:o.exspiretime,id:o.id,hidetime:o.hidetime});let e=j.indexOf({text:o.text,exspiretime:o.exspiretime,id:o.id,hidetime:o.hidetime});setTimeout(()=>{j=j.splice(0,e)},o.exspiretime);break}case"Levels":e7=o,v();break;case"handshake":break;case"updaterHeal":if(!x[o.id])return;x[o.id].playerHealTime=o.HEALTime;break;case"playerHeal":x[o.id].health=o.HEALTH,o.id===s&&(E=o.HEALTH);break;case"statsTreeRestart":x[o.id].statsTree=o.stats;break;case"autoCannonUPDATE-ADD":ef=o;break;case"badgeToplayer":eW=o.badge,e$.src=`https://deip-io3.glitch.me${eW}?nocache=${Date.now()}`;break;case"announcements":q=o;break;case"boardUpdate":eA=o.leader_board;break;case"autoCannonUPDATE-ANGLE":ef.forEach(e=>{e.CannonID===o.cannon_ID&&(e.angle=o.angle)});break;case"playerMoved":x[o.id].x=o.x,x[o.id].y=o.y;break;case"playerCannonUpdated":try{o.receiver?o.receiver===s&&(x[o.id].cannon_angle=o.cannon_angle):x[o.id].cannon_angle=o.cannon_angle}catch{}break;case"playerLeft":x=Object.entries(x).reduce((e,[t,a])=>(t!==o.playerID&&(e[t]=a),e),{});break;case"playerDied":if(o.playerID===s){setTimeout(()=>{document.getElementById("die").style.display="block",document.getElementById("container").style.display="none",document.getElementById("tanktiles").style.display="none"},10),_=!0,clearInterval(ti),eh.forEach(e=>{clearTimeout(e)}),eh=[],ty=()=>{},tg=()=>{},(y=document.getElementById("myCanvas")).style["z-index"]="5";let e=document.createElement("button");ta=(e,t)=>{},e.innerHTML="Respawn",e.style.position="absolute",e.style.top="calc(50vh - 50px)",e.style.left="calc(50vw - 100px)",e.style.width="200px",e.style.height="100px",e.style["z-index"]="12",document.getElementsByTagName("body")[0].style.cursor="auto",document.getElementById("game").appendChild(e),e.addEventListener("click",()=>{l.close(),h()})}else o.rewarder===s&&o.reward&&(O+=o.reward);x=Object.entries(x).reduce((e,[t,a])=>(t!==o.playerID&&(e[t]=a),e),{});break;case"bossUpdate":ej=o;break;case"playerDamaged":x[o.player1.id].health=o.player1.health,o.player2.id===s&&(E=o.player2.health,B=0,ta("statechange",{state:eP="damaged",statecycle:eL=0}),setTimeout(()=>{ta("statechange",{state:eP="normal",statecycle:eL=0})},1e3)),o.player1.id===s&&(E=o.player1.health,B=0,ta("statechange",{state:eP="damaged",statecycle:eL=0}),setTimeout(()=>{ta("statechange",{state:eP="normal",statecycle:eL=0})},1e3)),x[o.player2.id].health=o.player2.health;break;case"bulletUpdate":er=o;break;case"roadUpdate":ed=o;break;case"playerJoined":console.log(o),x[o.id]=o,s!==o.id&&ta("updatePlayer",{id:s,x:S,y:T,health:E,speed:L,size:M,bodyDamage:R,cannonW:ep,cannonH:0,__type__:A,cannon_angle:tl(),score:O,username:e,level:$,state:eP,statecycle:eL,playerHealTime:B,maxhealth:I,playerReheal:P,FOV:tb,canvasW:y.width,canvasH:y.height,MouseX:et,Regenspeed:eq,MouseY:ea,screenWidth:y.width,screenHeight:y.height,autoFiring:ec,skin:D,statsTree:{Health:1,"Body Damage":1,Regen:1,"Bullet Pentration":1,"Bullet Speed":1,"Bullet Damage":1,"Bullet Reload":1,Speed:1},team:F,userId:eV}),setTimeout(()=>{ta("healrate",{playerReheal:P})},3e3);break;case"playerScore":x[o.bulletId].score+=o.socrepluse,o.bulletId===s&&(O=x[o.bulletId].score),ts(),o.kill;break;case"dronekilled":o.droneID===s&&(eu-=1);break;case"colorUpgrades":e5=o;break;case"teamColorUpgrades":e3=o;break;case"UpdateStatTree":"Health"===o.StatUpgradetype&&(x[o.id].health=x[o.id].health/2*o.levelmultiplyer,x[o.id].maxhealth=x[o.id].maxhealth*o.levelmultiplyer,o.id===s&&(E=x[o.id].health/2*o.levelmultiplyer,I=x[o.id].maxhealth*o.levelmultiplyer)),"Body Damage"===o.StatUpgradetype?(x[o.id].bodyDamage*=o.levelmultiplyer,o.id===s&&(R*=o.levelmultiplyer)):"Speed"===o.StatUpgradetype?x[o.id].speed*=o.levelmultiplyer:"Bullet Reload"===o.StatUpgradetype&&o.id===s&&(e2/=o.levelmultiplyer);break;case"healerRestart":x[o.id].Regenspeed=o.Regenspeed,o.id===s&&(eq=o.Regenspeed);break;case"pubteamlist":eJ=o;var d=document.getElementById("teamcontainer");d.innerHTML="",td();break;case"privateteamlist":var d=document.getElementById("teamcontainer");d.innerHTML="",td();break;case"JoinTeamSuccess":o.id===s&&(H=!0,e6.style.display="block");break;case"playerJoinedTeam":x[o.id].team=o.teamId,o.id===s&&null!==o.teamId&&(H=!0,e6.style.display="block",F=o.teamId),o.id===s&&null===o.teamId&&(H=!1,e6.style.display="none",N=!1,F=null);break;case"newOwner":o.teamID===F&&(N=!0);break;case"bulletDamage":x[o.playerID]?(er=o.BULLETS,x[o.playerID].health=o.playerHealth,o.playerID==s&&(E=o.playerHealth,ta("playerHealintterupted",{}),B=0,ta("statechange",{state:eP="damaged",statecycle:eL}),setTimeout(()=>{ta("statechange",{state:eP="normal",statecycle:eL})},1e3))):console.warn("Received bulletDamage for an unknown player:",o.playerID);break;case"bulletHeal":x[o.playerID]?(x[o.playerID].health=o.playerHealth,o.playerID===s&&(E=o.playerHealth)):console.warn("Received bulletDamage for an unknown player:",o.playerID);break;case"shapeDamage":x[o.PlayerId]?(x[o.PlayerId].health-=o.playerDamage,o.PlayerId==s&&(ta("statechange",{state:eP="damaged",statecycle:eL}),setTimeout(()=>{ta("statechange",{state:eP="normal",statecycle:eL})},1e3),E-=o.playerDamage,B=0,ta("playerHealintterupted",{}))):console.warn("Received shapeDamage for an unknown player:",o.PlayerId);break;case"bouceBack":{if(o.playerID!==s)return;J=!1,Z.forEach(e=>{e.bouceBack||clearTimeout(e.timeout)}),Z=[];let e=2*L;for(let t=0;t<L/2;t++){let a=setTimeout(()=>{to(-(1.1*o.response.x/e),-(1.1*o.response.y/e)),t<L/2&&(J=!0)},85*t);Z.push({timeout:a,bouceBack:!0})}break}case"type_Change":x[o.id]=o;break;case"postBiteMessage":console.log(o),o.forEach(e=>{document.getElementById("socialContainer").innerHTML=`
                  <div class="con-435874358">
                    <div class="social-con">
                      <div class="socialLevelDiv" id="social">
                        <div class="socialContainer">
                          <div class="flexbuild">
                            <textarea
                              cols="30"
                              class="textsocial"
                              id="posttext"
                              maxlength="256"
                            ></textarea>
                            <button class="post-button" id="postBite">Post a bite</button>
                          </div>
                          <a style="font-size: 10px" href="/posting-policy.html"
                            >By posting your are agreeing to Tankshark's Posting Policy
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                `;var t=document.getElementById("social"),a=document.createElement("div"),l=document.createElement("p");a.classList.add("message"),l.innerText=`${e.username}: ${e.message}`,a.appendChild(l),l.style.display="block";for(let t=0;t<2;t++){var n=document.createElement("div"),o=document.createElement("img");o.src=e9[t],a.appendChild(n),o.classList.add("like-dislike-img"),n.classList.add("like-dislike-div"),o.addEventListener("click",()=>{ta("likeDislike",{id:e.id,type:t})}),n.appendChild(o),n.style.display="inline-block";var i=()=>{var a="";return 0===t&&e.dislikers.forEach(e=>{a+=e+"\n"}),1===t&&e.likers.forEach(e=>{a+=e+"\n"}),a}}a.innerHTML+=`<style>.like-dislike-div:hover::after {content: "${i()}" !important}</style>`,t.insertBefore(a,t.children[0])});break;case"statechangeUpdate":if(!x[o.playerID])return;x[o.playerID].state=o.state,o.playerID===s&&(eP=o.state);break;case"statecycleUpdate":if(!x[o.playerID])return;x[o.playerID].statecycle=o.statecycle,o.playerID===s&&(eL=o.statecycle);break;case"playerCannonWidthUpdate":x[o.id].cannonW=o.cannonW;break;case"playerCannonUpdatedInactive":et=o.MouseX_,ea=o.MouseY_,o.autoAngle;break;case"newid":var c=eV=o.newid;let m=new Date;m.setTime(m.getTime()+31536e6);let p="expires="+m.toUTCString();document.cookie="userId="+c+";"+p+";path=/";break;case"playerSpeedBoost":o.id===s&&(V=o.speedMultiplyer);break;default:console.log("Empty action received.",a)}},document.getElementById("miniMap").addEventListener("click",()=>{ta("requestUpgrade",{upgradeType:"miniMap",teamId:F})}),document.addEventListener("visibilitychange",()=>{ta("windowStateChange",{vis:document.visibilityState,id:s})});let to=(e,t,a,l)=>{e*=V,t*=V,Z.shift(),J&&(eb+=e,T+=t,ev+=t,S+=e,l in eO||ta("playerMoved",{x:S,y:T,dx:e,dy:t,last:a}))},ti=setInterval(()=>{B+=1,ta("AddplayerHealTime",{playerHealTime:B,maxhealth:I})},1e3);function tr(e,t){return Math.random()*(t-e)+e}function tc(e,t,a,l){ep[e]=ep[e]||0;for(let t=0;t<10;t++)setTimeout(()=>{ep[e]-=1,ta("playerCannonWidth",{cannonW:ep})},10*t),setTimeout(()=>{ep[e]+=1,ta("playerCannonWidth",{cannonW:ep})},20*t);let n=-(t/10*a*Math.cos(l)),o=-(t/10*a*Math.sin(l));for(let e=0;e<L;e++)setTimeout(()=>{to(n/15,o/15,e==L-1)},15*e)}function ty(e,t){let a=b[A],l=a.cannons;if(ec||t||2!==e.button){var n=tl();l.forEach((e,l)=>{eg[l]&&(eg[l]=!1,setTimeout(()=>{if("autoCannon"===e.type||"SwivelAutoCannon"===e.type||!t&&"directer"===e.type)return;let a=15*e.bulletSize,o=tr(-.2,.2);if("basicCannon"===e.type||"trap"===e.type)var i=e["cannon-width"]-a/2,r=e["cannon-height"]-e["cannon-height"],s=n+e["offset-angle"];else if("trapezoid"===e.type)var s=n+e["offset-angle"]+o,i=e["cannon-width-top"],r=e["cannon-height"]-2*a-e["cannon-width-top"]/2*Math.random();else if("AutoBulletCannon"===e.type)var i=e["cannon-width"]-a/2,r=e["cannon-height"]-a/2,s=n+e["offset-angle"];else if("rocketer"===e.type)var i=e["cannon-width-bottom"]+a/2,r=e["cannon-height"]-e["cannon-width-bottom"],s=n+e["offset-angle"];else var i=e["cannon-height"]+a/2,r=0,s=n+e["offset-angle"];let d=(e["offSet-x"]+i)*Math.cos(s)-(e["offSet-y"]+r)*Math.sin(s),c=(e["offSet-x"]+i)*Math.sin(s)+(e["offSet-y"]+r)*Math.cos(s),h=S+d,y=T+c,g=Date.now()+Math.random(),m=4*e.bulletSpeed;tc(l,a,m,s);let p=0;if("basicCannon"===e.type||"trapezoid"===e.type)var u=100*m*2.5,f="basic",b=8;else if("trap"===e.type){var u=70*m*.75,f="trap",b=10;p=tk(h,y,a,0)}else if("directer"===e.type){var u=100,f="directer",b=10;p=tk(h,y,a,0)}else if("AutoBulletCannon"===e.type)var u=105*m*2.5,f="AutoBullet",b=8;else if("rocketer"===e.type)var u=100*m*3,f="rocketer",b=9;else if("paver"===e.type)var u=100*m*3,f="roadMap",b=6;let v=e["life-time"]||0,k={type:f,bullet_distance:u,speed:m,size:a,angle:s,bullet_damage:em*e.bulletSize,distanceTraveled:0,vertices:p,bullet_pentration:2*e.bullet_pentration,x:h,y:y,lifespan:v,parentindex:l,health:b,xstart:S,ystart:T,uniqueid:g,cannonIndex:l};ta("bulletFired",k)},1e3*e.delay),eg[l]||b.dronetanks.includes(A)||setTimeout(()=>{eg[l]=!0},ey*a["reaload-m"]*e.reloadM*e2))})}}function tg(e){let t=b[A],a=t.cannons;ec||(ec||!e||2!==e.button)&&a.forEach((l,n)=>{eo[name=JSON.stringify((ei=setInterval((t=e,o=ea,i=et)=>{let r=tl();ec||setTimeout(()=>{if("autoCannon"===l.type||"SwivelAutoCannon"===l.type)return;let e=15*l.bulletSize,t=tr(-.2,.2);if("basicCannon"===l.type||"trap"===l.type)var a=l["cannon-width"]-e/2,o=l["cannon-height"]-l["cannon-height"],i=r+l["offset-angle"];else if("trapezoid"===l.type)var i=r+l["offset-angle"]+t,a=l["cannon-width-top"]-1.5*e,o=l["cannon-height"]-2*e-l["cannon-width-top"]/2*Math.random();else if("directer"===l.type){var s=100,d="directer",c=10;f=tk(g,m,e,0)}else if("AutoBulletCannon"===l.type)var a=l["cannon-width"]-1.5*e,o=l["cannon-height"]-2*e,i=r+l["offset-angle"];else if("rocketer"===l.type)var a=l["cannon-width-bottom"]+2*e,o=l["cannon-height"]-l["cannon-width-bottom"],i=r+l["offset-angle"];else var a=l["cannon-width-top"]/2,o=l["cannon-width-top"]/2,i=r+l["offset-angle"];let h=(l["offSet-x"]+a)*Math.cos(i)-(l["offSet-y"]+o)*Math.sin(i),y=(l["offSet-x"]+a)*Math.sin(i)+(l["offSet-y"]+o)*Math.cos(i),g=S+h,m=T+y,p=Date.now()+Math.random(),u=4*l.bulletSpeed;tc(n,e,u,i);let f=0;if("basicCannon"===l.type||"trapezoid"===l.type)var s=100*u*2.5,d="basic",c=8;else if("trap"===l.type){var s=70*u*.75,d="trap",c=10;f=tk(g,m,e,0)}else if("directer"===l.type){var s=100,d="directer",c=10;u+=10,f=tk(g,m,e,0)}else if("AutoBulletCannon"===l.type)var s=105*u*2.5,d="AutoBullet",c=8;else if("rocketer"===l.type)var s=100*u*3,d="rocketer",c=9;else if("paver"===l.type)var s=100*u*3,d="roadMap",c=6;let b=l["life-time"]||0,v={type:d,bullet_distance:s,speed:u,size:e,angle:i,bullet_damage:em*l.bulletSize,distanceTraveled:0,vertices:f,bullet_pentration:2*l.bullet_pentration,x:g,y:m,lifespan:b,health:c,parentindex:n,xstart:S,ystart:T,uniqueid:p,cannonIndex:n};ta("bulletFired",v)},1e3*a[n].delay)},ey*t["reaload-m"]*l.reloadM*e2))+n)]=ei})}window.outerHeight>window.outerWidth&&(document.getElementById("keyscontainer").style.display="block",document.getElementById("up").addEventListener("touchstart",()=>{X||(K.ArrowUp=!0)}),document.getElementById("up").addEventListener("touchend",()=>{delete K.ArrowUp}),document.getElementById("down").addEventListener("touchstart",()=>{X||(K.ArrowDown=!0)}),document.getElementById("down").addEventListener("touchend",()=>{delete K.ArrowDown}),document.getElementById("left").addEventListener("touchstart",()=>{X||(K.ArrowLeft=!0)}),document.getElementById("left").addEventListener("touchend",()=>{delete K.ArrowLeft}),document.getElementById("right").addEventListener("touchstart",()=>{X||(K.ArrowRight=!0)}),document.getElementById("right").addEventListener("touchend",()=>{delete K.ArrowRight})),document.addEventListener("keydown",e=>{K[e.key]=!0,X&&(K.Backspace||K.Delete||K.Enter||!(eK.length<35)?eK=eK.slice(0,-1):eK+=e.key),K.Enter&&(X&&""!==eK&&(ta("playerSend",{text:eK}),eK=""),X||setTimeout(()=>{!function e(){G=!G,X&&setTimeout(()=>{e()},530)}()},530),X=!X)}),document.addEventListener("keyup",e=>{delete K[e.key]}),document.addEventListener("mousemove",e=>{var t=a(window,e);if(!Q&&!ee){et=t.x,ea=t.y;let e=tl();ta("playerCannonMoved",{cannon_angle:e,MouseX:et,MouseY:ea})}el=t.x,en=t.y}),document.getElementById("teamButton").addEventListener("click",()=>{var e,t,a,l=document.getElementById("teamname").value,e=document.getElementById("hidden").checked,t=document.getElementById("private").checked,a=document.getElementById("teamScore").checked,n=document.getElementById("teamDescription").value,o=document.querySelector('input[name="teamType"]:checked').value,i=document.getElementById("ScheduledBased").value,r=document.getElementById("time-select").value,n=document.getElementById("Simple").value;document.getElementById("teambox").style.display="none",tT.innerText="Leave",tE.innerText="Delete",ta("newTeamCreated",{private:t,hidden:e,name:l,description:n,govType:o,createTeamScore:a,simpleTax:document.getElementById("Simple").value,playerTax:document.getElementById("scoreBased").value,ScheduledBasedTax:i,ScheduledBasedTaxInterval:r}),N=!0}),document.addEventListener("mousedown",e=>{eR||ty(e,!1)}),window.addEventListener("resize",()=>{tv(0)}),document.addEventListener("click",e=>{eR||e.preventDefault()});let tS=b[A];setTimeout(()=>{!function e(){if(tS=b[A],!b.dronetanks.includes(A)&&ec&&(tS=b[A],ei&&(clearInterval(ei),ei=null),ty()),b.dronetanks.includes(A)){let e=0;for(var{}in b[A].cannons)eu<=b[A].cannons[e]["max-drones"]&&"directer"===b[A].cannons[e].type&&(ty(null,!0),eg[e]=!0,eu+=1),e++}setTimeout(()=>{e()},ey*tS["reaload-m"]*e2)}()},ey*tS["reaload-m"]*e2),document.getElementById("Xbutton").addEventListener("click",()=>{eR=!1;var e=document.getElementById("teamcontainer"),t=document.getElementById("teamMain");e.style.display="none",t.style.display="none",document.getElementById("confermationScreen").style.display="none",document.getElementById("teambox").style.display="none",document.getElementsByTagName("body")[0].style.cursor="url('https://deip-io3.glitch.me/targetpointer1.cur'), auto"});var tT=document.getElementById("join/leave");tT.addEventListener("click",()=>{H?(ta("playerLeftTeam",{teamId:x[s].team}),tE.style.display="block",tE.innerText="Create",N&&(N=!1,document.getElementById("teambox").style.display="none",document.getElementsByClassName("outer-box")[0].classList.remove("outer-onwer-box"),document.getElementsByClassName("inner-box")[0].classList.remove("inner-onwer-box"),document.getElementById("confermationScreen").style.display="none",document.getElementById("upgradesBox").style.display="none"),tT.innerText="Join",H=!1,e6.style.display="none",W=null):null!==W&&(ta("playerJoinedTeam",{teamId:W}),tT.innerText="Leave",tE.style.display="none")});var tE=document.getElementById("create/delete");tE.addEventListener("click",()=>{N?N&&H&&ta("deleteTeam",{teamID:F}):document.getElementById("teambox").style.display="block"}),document.addEventListener("mousedown",e=>{if(window.innerWidth-475<el&&el<window.innerWidth-275&&en>10&&en<110&&!eR){eR=!0,document.getElementById("teamMain").style.display="block",W=null,document.getElementsByTagName("body")[0].style.cursor="auto";var t=document.getElementById("teamcontainer");t.style.display="block",t.style.height="95%",t.style.margin="5px",t.innerHTML="",td();return}!eR&&(b.dronetanks.includes(A)||eR||_?2!==e.button||_||ta("MouseAway",{}):tg(e))}),document.addEventListener("mouseup",()=>{for(let e in eo)clearInterval(ei=eo[e]),ei=null;ta("MousestateUpdate",{})})},0)};let ty=(e,t,a)=>{Z.shift(),eb+=e,T+=t,ev+=t,S+=e,ta("playerMoved",{x:S,y:T,dx:e,dy:t,last:a})},tg=()=>{for(let a in x){var e,t;let l=x[a],n=Math.sqrt((e=l.x-S)*e+(t=l.y-T)*t);if(n<l.size*z+M*z&&a!==s&&(x[a]?.team!==x[s]?.team||x[a]?.team===null||x[s]?.team===null)){if(ta("playerCollided",{id_other:a,damagetaken:l.bodyDamage,damagegiven:R,id_self:s}),B=0,ta("playerHealintterupted",{}),J=!1,setTimeout(()=>{J=!0},10*L),l.x<S)for(let e=0;e<L;e++)setTimeout(()=>{ty(-2,0,e===L-1,e)},50*e);if(l.x>S)for(let e=0;e<L;e++)setTimeout(()=>{ty(2,0,e===L-1,e)},50*e);if(l.y>T)for(let e=0;e<L;e++)setTimeout(()=>{ty(0,-2,e===L-1,e)},50*e);if(l.y<T)for(let e=0;e<L;e++)setTimeout(()=>{ty(0,2,e===L-1,e)},50*e)}else if(n<l.size*z+M*z&&a!==s){if(J=!1,setTimeout(()=>{J=!0},10*L),l.x<S)for(let e=0;e<L;e++)setTimeout(()=>{ty(-2,0,e===L-1,e)},50*e);if(l.x>S)for(let e=0;e<L;e++)setTimeout(()=>{ty(2,0,e===L-1,e)},50*e);if(l.y>T)for(let e=0;e<L;e++)setTimeout(()=>{ty(0,-2,e===L-1,e)},50*e);if(l.y<T)for(let e=0;e<L;e++)setTimeout(()=>{ty(0,2,e===L-1,e)},50*e)}}},tm=(e,t)=>{if(S+e>-5e3&&S+e<5e3&&T+t>-5e3&&T+t<5e3){for(let l=0;l<L/2;l++){var a=setTimeout(()=>{ty(e,t,l===L-1||0===l)},80*l);Z.push({timeout:a,bouceBack:!0})}tg(e,t)}else if(S+e>-5e3&&0===t){Z.forEach(e=>{clearTimeout(e.timeout)}),Z=[];for(let e=0;e<L/3;e++){var a=setTimeout(()=>{ty(-3,0,e===L-1||0===e)},75*e);Z.push({timeout:a,bouceBack:!0})}}else if(S+e<5e3&&0===t){Z.forEach(e=>{clearTimeout(e.timeout)}),Z=[];for(let e=0;e<L/3;e++){var a=setTimeout(()=>{ty(3,0,e===L-1||0===e)},75*e);Z.push({timeout:a,bouceBack:!0})}}else if(T>5e3){Z.forEach(e=>{clearTimeout(e.timeout)}),Z=[];for(let e=0;e<L/3;e++){var a=setTimeout(()=>{ty(0,-3,e===L-1||0===e)},75*e);Z.push({timeout:a,bouceBack:!0})}}if(T<-5e3){Z.forEach(e=>{clearTimeout(e.timeout)}),Z=[];for(let e=0;e<L/3;e++){var a=setTimeout(()=>{ty(0,3,e===L-1||0===e)},75*e);Z.push({timeout:a,bouceBack:!0})}}};var tp=y.width,tu=y.height;function tf(e,t,a){let l=Math.PI/180*a;return[e*Math.cos(l)-t*Math.sin(l),e*Math.sin(l)+t*Math.cos(l)]}var tb=1;function tv(e){tb-=e,tp=window.innerWidth,tu=window.innerHeight,y.width=tp,y.height=tu;var t=tp/(y.width*tb),a=tu/(y.height*tb);y.width*=t,y.height*=a,m.scale(tb,tb),ta("FOVUpdate",{scaleFactor:tb,canvasW:y.width,canvasH:y.height,screenW:tp,screenH:tu}),g.width=tp,g.height=tu,g.getBoundingClientRect();var l=ek,n=ew;ek=y.width,ew=y.height,S-=l/2,T-=n/2,S+=ek/2,T+=ew/2,S-=ek/2-l/2,T-=ew/2-n/2,eb-=ek/2-l/2,ev-=ew/2-n/2,teamwidth=.15625*y.width,teamheight=.3333333333333333*y.height,innerteamwidth=.14322916666*y.width,innerteamheight=.30833333333333335*y.height,innerteamwidthreal=.14322916666*window.innerWidth,innerteamheightreal=.30833333333333335*window.innerHeight,buttton140=.07291666666*y.width,button275=.14322916666*y.width,eH=137.499999994*t+237.5*t,e_=87.5*t+eH,eU=100*t+eH,button80=.07759456838*y.height,eF=.0208333333*y.width,eN=.00969932104*y.height,button110=.10669253152*y.height,eM=.3125*y.width,ez=.02909796314*y.height,document.getElementById("gridLight").style["grid-template-columns"]=`repeat(10, ${999*tb+1}px)`,document.getElementById("gridLight").style["grid-template-rows"]=`repeat(10, ${999*tb+1}px)`,document.getElementById("gridLight").style.width=`${1e4*tb}px`,document.getElementById("gridLight").style.height=`${1e4*tb}px`,document.getElementById("gridLight").childNodes.forEach(e=>{e.style.width=`${999*tb}px`,e.style.height=`${999*tb}px`}),document.getElementById("gridDark").style["grid-template-columns"]=`repeat(10, ${999*tb+1}px)`,document.getElementById("gridDark").style["grid-template-rows"]=`repeat(10, ${999*tb+1}px)`,document.getElementById("gridDark").style.width=`${1e4*tb}px`,document.getElementById("gridDark").style.height=`${1e4*tb}px`,document.getElementById("gridDark").childNodes.forEach(e=>{e.style.width=`${999*tb}px`,e.style.height=`${999*tb}px`})}function tk(e,t,a,l){let n=Math.sqrt(3)/2*a/Math.sqrt(3),o=[];for(let a=0;a<3;a++){let i=l+2*Math.PI/3*a,r=e+n*Math.cos(i),s=t+n*Math.sin(i);o.push({x:r,y:s})}return o}var tw=new class{constructor(e,t,a=500,l=27,n=500,o="bold 20px arial",i="center",r=3,s=100,d=10){this.announcements=t,this.ctx=e,this.anoucmentW=a,this.anoucmentW2=a/2,this.anoucmentH=l,this.dropDownTime=n,this.font=o,this.textAling=i,this.boundrectH=l+r,this.startHeight=s,this.shovespeed=d,this.shovespeed5=5*d,this.boundrectH10=this.boundrectH-10}run(){var e=50,t={},a=0;this.announcements.forEach(l=>{if(Date.now()<=l.shovedowndate){a++;var n=0;this.ctx.globalAlpha=l.trans,this.ctx.fillStyle=l.color,this.ctx.font="bold 20px arial",this.ctx.textAlign="center",Date.now()>=l.expiretime&&Date.now()<=l.shovedowndate&&(e=(e=this.shovespeed5/((l.shovedowndate-Date.now())/this.dropDownTime))<=0?0:e,t=l),n=e,Date.now()<=l.expiretime&&(n=(n=n>=this.shovespeed5?this.shovespeed5:n)<=0?0:n),Date.now()<=t.shovedowndate&&(n-=(t.shovedowndate-Date.now())/this.shovespeed<this.boundrectH?(t.shovedowndate-Date.now())/this.shovespeed:this.boundrectH,n+=this.boundrectH),n=n<=0?0:n,this.ctx.globalAlpha-=(y.height/2-(this.startHeight-n-this.boundrectH10+a*this.boundrectH*1))/y.height,this.ctx.beginPath(),this.ctx.roundRect(y.width/2-this.anoucmentW2,this.startHeight-n-this.boundrectH10+a*this.boundrectH*1,+this.anoucmentW,+this.anoucmentH,l.rounding),this.ctx.fill(),this.ctx.closePath(),this.ctx.fillText(l.text,y.width/2,(this.startHeight-n+a*this.boundrectH)*1)}}),this.ctx.globalAlpha=1}}(m,q);function tx(e){m.fillStyle="black",m.beginPath(),m.roundRect(-45,35,90,10,5),m.fill(),m.closePath();let t=e.health/e.maxhealth*90;m.fillStyle="green",m.beginPath(),m.roundRect(-45,35,t,10,5),m.fill(),m.closePath()}}async function y(){let e="https://tankshark.fun/"===window.location.href?"https://websocketpointer.duckdns.org/currentbadge":"http://localhost:4500/currentbadge";try{let t=await fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({userId:n("userId")})});if(!t.ok)throw Error(`Response status: ${t.status}`);return await t.json()}catch(e){console.error(e.message)}}async function g(){let e="https://tankshark.fun/"===window.location.href?"https://websocketpointer.duckdns.org/submit-feedback":"http://localhost:4500/submit-feedback";try{let t=await fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({name:document.getElementById("namesub").value,message:document.getElementById("feedback").value})});if(!t.ok)throw Error(`Response status: ${t.status}`);return await t.json()}catch(e){console.error(e.message)}}document.getElementById("subfeedback").addEventListener("click",g);let m=!1;async function p(){let e="https://tankshark.fun/"===window.location.href?"https://websocketpointer.duckdns.org/leaderboard":"http://localhost:4500/leaderboard";try{let t=await fetch(e);if(!t.ok)throw Error(`Response status: ${t.status}`);return await t.json()}catch(e){console.error(e.message)}}async function u(){Promise.all(("https://tankshark.fun/"!==window.location.href?["http://localhost:4500/ping","https://websocketpointer.duckdns.org/ping","http://127.0.0.1:4000/ping","http://192.168.9.100:4500/ping"]:["https://websocketpointer.duckdns.org/ping"]).map(async e=>{try{let t=await fetch(e);if(!t.ok)throw Error(`Response status: ${t.status}`)}catch(e){console.log(e.message)}})).then(()=>{})}document.getElementById("settingsOpener").addEventListener("click",()=>{m=!m,document.getElementById("settingsBox").style.display=m?"block":"none"}),async function(){var e=await p(),t=document.getElementById("leaderBoard");t.innerHTML="",e.leader_board.forEach(e=>{var a=document.createElement("div"),l=document.createElement("p"),n=document.createElement("img");t.appendChild(a),a.appendChild(n),n.src="https://tankshark.fun/"!==window.location.href?`/public${e.badge.badge}`:`${e.badge.badge}`,a.classList.add("entrie-box"),a.appendChild(l),l.innerHTML=`${e.username}, ${e.score}`,l.classList.add("normalized-text-color"),n.style.width="20px",n.style.hieght="20px",n.alt="io leaderboard badge"})}(),"https://tankshark.fun/"===window.location.href&&(document.getElementById("squareimg").src="/how-to-imgs/square.webp",document.getElementById("triangleimg").src="/how-to-imgs/triangle.webp",document.getElementById("pentagonimg").src="/how-to-imgs/pentagon.webp"),u();var f=null;let b=0;!async function(){f=await y(),P.innerHTML="",f.levelData.reverse().forEach((e,t)=>{var a=document.createElement("div");P.appendChild(a),a.classList.add("levelContainer");var l=document.createElement("img");if((e.maxScore>=f.playerScore||null==e.maxScore)&&(a.classList.add("disabledBadge"),l.style.filter="brightness(50%)"),e.maxScore>=f.playerScore&&e.minScore<=f.playerScore){let t=e.minScore,s=e.maxScore;var n=255*((s-f.playerScore)/(s-t));s-f.playerScore==s-t&&(n=0);var o=`linear-gradient(0deg, rgba(${n}, ${n}, ${n}, 0.4), rgba(0, 0, 0, 0.4))`;a.style.backgroundImage=o;var i=90*Math.PI*((s-f.playerScore)/(s-t));a.innerHTML=`
          <svg width="10vh" height="10vh" viewBox="0 0 130 100">
            <defs>
              <radialGradient id="grad1" x1="0%" x2="100%" y1="0%" y2="0%">
                <stop offset="0%" stop-color="#00F7FF12" />
                <stop offset="50%" stop-color="#00F7FF" />
                <stop offset="100%" stop-color="#00F7FF12" />
              </radialGradient>
              <radialGradient id="grad2" x1="0%" x2="100%" y1="0%" y2="0%">
                <stop offset="0%" stop-color="#FFFFFF00" />
                <stop offset="100%" stop-color="#00F7FF" />
              </radialGradient>
            </defs>
            <g stroke-width="9" stroke="url(#grad1)" fill="none" stroke-width="30">
              <circle r="65" cx="65" cy="50" opacity="1" stroke="url(#grad1)" stroke-width="30"></circle>
              <circle r="45" cx="65" cy="50"></circle>
            </g>
            <circle cx="65" cy="50" r="45" stroke="black" stroke-width="8" fill="none"> </circle>
            <circle cx="65" cy="50" r="45" class="meter-1" id="fillcircle"> </circle>
            <image x="35" y="20" width="60" height="60" href='${"https://tankshark.fun/"!==window.location.href?window.location.origin+"/public/"+e.badge:window.location.origin+e.badge}'> </image>
          </svg>
        `;let d=document.getElementById("fillcircle"),c=90*Math.PI;d.style.setProperty("stroke-dasharray",`${c}`),d.style.setProperty("stroke-dashoffset",i),l.style.opacity="0.1",l.style.width="0.1px";var r=document.createElement("progress");r.value=(s-f.playerScore)/(s-t),r.style.width="100%",r.style.marginRight="10px",r.classList.add("lineBreak"),r.style.display="block",r.style["background-color"]="#0A0A0A"}l.src="https://tankshark.fun/"!==window.location.href?`/public${e.badge}`:`${e.badge}`,l.alt=`badge level: ${e}`,a.appendChild(l),l.style.height="4.5vw",l.style.minHeight="70px",a.style.minHeight="80px",e.maxScore>=f.playerScore&&e.minScore<=f.playerScore?(l.style.visibility="hidden",a.style.setProperty("border-color","var(--border-color-400)","important")):l["aspect-ratio"]="1 / 1"})}();var v=!0,k=document.getElementById("darkModeCheck"),w=document.getElementById("chatcheck"),x=document.getElementById("leaderBoardCheck"),S=document.getElementById("namesCheck");k.addEventListener("click",()=>{document.getElementById("getdarkMode").classList.toggle("moveee"),s=!s,localStorage.setItem("theme",s);var e=s?"dark":"light";document.querySelector("html").setAttribute("data-theme",e),s&&(document.getElementById("gridDark").style.display="grid",document.getElementById("gridLight").style.display="none"),s||(document.getElementById("gridDark").style.display="none",document.getElementById("gridLight").style.display="grid")}),w.addEventListener("click",()=>{r=!r,localStorage.setItem("canSeeChat",r),document.getElementById("getChatShown").classList.toggle("moveee")}),x.addEventListener("click",()=>{d=!d,localStorage.setItem("canSeeLeaderBoard",d),document.getElementById("getleaderBoardShown").classList.toggle("moveee")}),S.addEventListener("click",()=>{c=!c,localStorage.setItem("canSeeNames",c),document.getElementById("getnamesShown").classList.toggle("moveee")});var T=document.getElementById("playerCanvas");let E=T.getContext("2d");s=localStorage.getItem("theme"),c=localStorage.getItem("canSeeNames"),d=localStorage.getItem("canSeeLeaderBoard"),r=localStorage.getItem("canSeeChat"),null==(s="true"===s)&&localStorage.setItem("theme",!1),null==c&&localStorage.setItem("canSeeNames",!0),null==r&&localStorage.setItem("canSeeChat",!0),null==d&&localStorage.setItem("canSeeLeaderBoard",!0),s??=!1,c="true"===c||null===c,r="true"===r||null===r,d="true"===d||null===d;var I=s?"dark":"light";s&&document.getElementById("getdarkMode").classList.toggle("moveee"),c&&document.getElementById("getnamesShown").classList.toggle("moveee"),r&&document.getElementById("getChatShown").classList.toggle("moveee"),d&&document.getElementById("getleaderBoardShown").classList.toggle("moveee"),document.querySelector("html").setAttribute("data-theme",I),s&&(document.getElementById("gridDark").style.display="grid",document.getElementById("gridLight").style.display="none"),s||(document.getElementById("gridDark").style.display="none",document.getElementById("gridLight").style.display="grid"),requestAnimationFrame(function e(){E.clearRect(0,0,T.width,T.height);let t=E.createRadialGradient(T.width/2,T.height/2,40,T.width/2,T.height/2,50);t.addColorStop(.1,"#00000000"),t.addColorStop(.5,"#61f7ff"),t.addColorStop(1,"#FFFFFF00"),E.beginPath(),E.arc(T.width/2,T.height/2,50,0,2*Math.PI,!1),E.fillStyle=t,E.fill(),E.closePath(),E.fillStyle="#b3b3b3",E.save(),E.translate(T.width/2,T.height/2),E.rotate(b);if(E.fillRect(-30,-15,120,30),E.strokeStyle="lightgrey",E.lineWidth=3,E.strokeRect(-30,-15,120,30),E.restore(),E.beginPath(),E.arc(T.width/2,T.height/2,40,0,2*Math.PI,!1),E.fillStyle="#828282",E.fill(),E.lineWidth=5,E.strokeStyle="#aaaaaa",E.stroke(),0!==C){let e=o[C];E.save(),E.translate(T.width/2,T.height/2),E.rotate(b),E.drawImage(e,-40,-40,80,80),E.restore()}v&&requestAnimationFrame(e)});let B=e=>{var t=a(T,e);b=l(T,t.x,t.y)};document.addEventListener("mousemove",e=>B(e));var P=document.getElementById("badgeLevelDiv");T.style["background-image"]="https://tankshark.fun/"!==window.location.href?`url(${window.location.origin}/public/assets/cropped/hexbackground.webp)`:`url(${window.location.origin}/assets/cropped/hexbackground.webp)`;var L=document.getElementById("skins-grid");document.getElementById("close").addEventListener("click",()=>{document.getElementById("skinCon").style.display="none",A=!1});var D="0.webp",C=0;document.getElementById("skinsButton").addEventListener("click",()=>{document.getElementById("skinCon").style.display="block"});for(let e=0;e<11;e++){var M=document.createElement("div"),z=document.createElement("img");L.appendChild(M),M.appendChild(z),z.src="https://tankshark.fun/"!==window.location.href?`/public/skins/${e}.webp`:`/skins/${e}.webp`,z.classList.add("_100per_"),M.classList.add("skin-div");var R=()=>{C=e,D=`${e}.webp`,[...document.getElementById("skins-grid").children].forEach(e=>{e.classList.remove("selected-skin")}),document.getElementById("skins-grid").children[e+1].classList.add("selected-skin")};M.addEventListener("click",R)}var A=!1;document.getElementById("skinButton").addEventListener("click",()=>{A=!A,document.getElementById("skinCon").style.display=A?"grid":"none"});let W=()=>{e=document.getElementById("username").value,document.removeEventListener("mousemove",e=>B(e)),v=!1,document.getElementById("full-screen").style.display="flex",e?setTimeout(()=>{document.getElementById("landing-page").style.display="none",document.getElementById("game").style.display="block","A"!==e&&document.addEventListener("contextmenu",e=>e.preventDefault()),h()},100):setTimeout(()=>{e="unknown-"+Math.round(1e3*Math.random()+0),document.getElementById("landing-page").style.display="none",document.getElementById("game").style.display="block",h()},100)};window.addEventListener("load",()=>{document.getElementById("playButton").addEventListener("mousedown",W)})}(),console.log("%c%s %c%s %c%s %c%s %c%s %c%s %c%s","color:white","Wellcome","color:red","skill issues!!!","color:white","Don't run scripts in here from stragers (Or anyone). Just don't","color:red","A good person is a person that clicks the X button of dev tools","color:white","\n\n\n\n","color:red","X","color:white","\n \n \n \n \n \n");
//# sourceMappingURL=public.3be83d56.js.map
